10/13/2023 16:10:16 - INFO -   Effective parameters:
10/13/2023 16:10:16 - INFO -     <<< batch_size: 64
10/13/2023 16:10:16 - INFO -     <<< batch_size_val: 1
10/13/2023 16:10:16 - INFO -     <<< cache_dir: 
10/13/2023 16:10:16 - INFO -     <<< coef_lr: 0.001
10/13/2023 16:10:16 - INFO -     <<< cross_model: cross-base
10/13/2023 16:10:16 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 16:10:16 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 16:10:16 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 16:10:16 - INFO -     <<< datatype: moviegraph
10/13/2023 16:10:16 - INFO -     <<< do_eval: True
10/13/2023 16:10:16 - INFO -     <<< do_lower_case: False
10/13/2023 16:10:16 - INFO -     <<< do_pretrain: False
10/13/2023 16:10:16 - INFO -     <<< do_train: False
10/13/2023 16:10:16 - INFO -     <<< epochs: 10
10/13/2023 16:10:16 - INFO -     <<< eval_frame_order: 0
10/13/2023 16:10:16 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 16:10:16 - INFO -     <<< feature_framerate: 1
10/13/2023 16:10:16 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 16:10:16 - INFO -     <<< fp16: False
10/13/2023 16:10:16 - INFO -     <<< fp16_opt_level: O1
10/13/2023 16:10:16 - INFO -     <<< freeze_layer_num: 0
10/13/2023 16:10:16 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 16:10:16 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 16:10:16 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 16:10:16 - INFO -     <<< linear_patch: 2d
10/13/2023 16:10:16 - INFO -     <<< local_rank: 0
10/13/2023 16:10:16 - INFO -     <<< loose_type: True
10/13/2023 16:10:16 - INFO -     <<< lr: 0.0001
10/13/2023 16:10:16 - INFO -     <<< lr_decay: 0.9
10/13/2023 16:10:16 - INFO -     <<< manipulation: temporal_int
10/13/2023 16:10:16 - INFO -     <<< margin: 0.1
10/13/2023 16:10:16 - INFO -     <<< max_frames: 12
10/13/2023 16:10:16 - INFO -     <<< max_words: 60
10/13/2023 16:10:16 - INFO -     <<< n_display: 1
10/13/2023 16:10:16 - INFO -     <<< n_gpu: 1
10/13/2023 16:10:16 - INFO -     <<< n_pair: 1
10/13/2023 16:10:16 - INFO -     <<< negative_weighting: 1
10/13/2023 16:10:16 - INFO -     <<< num_thread_reader: 8
10/13/2023 16:10:16 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 16:10:16 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 16:10:16 - INFO -     <<< rank: 0
10/13/2023 16:10:16 - INFO -     <<< resume_model: None
10/13/2023 16:10:16 - INFO -     <<< sampled_use_mil: False
10/13/2023 16:10:16 - INFO -     <<< scale: 0
10/13/2023 16:10:16 - INFO -     <<< seed: 3
10/13/2023 16:10:16 - INFO -     <<< sim_header: seqTransf
10/13/2023 16:10:16 - INFO -     <<< slice_framepos: 2
10/13/2023 16:10:16 - INFO -     <<< task_type: retrieval
10/13/2023 16:10:16 - INFO -     <<< test_file: test_data_full/temporal_int.csv
10/13/2023 16:10:16 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 16:10:16 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 16:10:16 - INFO -     <<< train_file: train2.csv
10/13/2023 16:10:16 - INFO -     <<< train_frame_order: 0
10/13/2023 16:10:16 - INFO -     <<< use_mil: False
10/13/2023 16:10:16 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 16:10:16 - INFO -     <<< val_file: test_data_full/temporal_int.csv
10/13/2023 16:10:16 - INFO -     <<< video_dim: 1024
10/13/2023 16:10:16 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 16:10:16 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 16:10:16 - INFO -     <<< world_size: 1
10/13/2023 16:10:16 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 16:10:19 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 16:10:19 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 16:10:19 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 16:10:19 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 16:10:19 - WARNING -   Test retrieval by loose type.
10/13/2023 16:10:19 - WARNING -   	 embed_dim: 512
10/13/2023 16:10:19 - WARNING -   	 image_resolution: 224
10/13/2023 16:10:19 - WARNING -   	 vision_layers: 12
10/13/2023 16:10:19 - WARNING -   	 vision_width: 768
10/13/2023 16:10:19 - WARNING -   	 vision_patch_size: 32
10/13/2023 16:10:19 - WARNING -   	 context_length: 77
10/13/2023 16:10:19 - WARNING -   	 vocab_size: 49408
10/13/2023 16:10:19 - WARNING -   	 transformer_width: 512
10/13/2023 16:10:19 - WARNING -   	 transformer_heads: 8
10/13/2023 16:10:19 - WARNING -   	 transformer_layers: 12
10/13/2023 16:10:19 - WARNING -   		 linear_patch: 2d
10/13/2023 16:10:19 - WARNING -   	 cut_top_layer: 0
10/13/2023 16:10:20 - WARNING -   	 sim_header: seqTransf
10/13/2023 16:10:27 - INFO -   --------------------
10/13/2023 16:10:27 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 16:10:27 - INFO -   ***** Running test *****
10/13/2023 16:10:27 - INFO -     Num examples = 563
10/13/2023 16:10:27 - INFO -     Batch size = 1
10/13/2023 16:10:27 - INFO -     Num steps = 563
10/13/2023 16:10:27 - INFO -   ***** Running val *****
10/13/2023 16:10:27 - INFO -     Num examples = 563
10/13/2023 16:53:20 - INFO -   sim matrix size: 563, 563
10/13/2023 16:53:20 - INFO -   	 Length-T: 563, Length-V:563
10/13/2023 16:53:20 - INFO -   Text-to-Video:
10/13/2023 16:53:20 - INFO -   	>>>  R@1: 26.3 - R@5: 64.3 - R@10: 78.7 - Median R: 3.0 - Mean R: 9.8
10/13/2023 16:53:20 - INFO -   Video-to-Text:
10/13/2023 16:53:20 - INFO -   	>>>  V2T$R@1: 28.2 - V2T$R@5: 63.8 - V2T$R@10: 79.4 - V2T$Median R: 3.0 - V2T$Mean R: 9.0
10/13/2023 16:53:26 - INFO -   Effective parameters:
10/13/2023 16:53:26 - INFO -     <<< batch_size: 64
10/13/2023 16:53:26 - INFO -     <<< batch_size_val: 1
10/13/2023 16:53:26 - INFO -     <<< cache_dir: 
10/13/2023 16:53:26 - INFO -     <<< coef_lr: 0.001
10/13/2023 16:53:26 - INFO -     <<< cross_model: cross-base
10/13/2023 16:53:26 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 16:53:26 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 16:53:26 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 16:53:26 - INFO -     <<< datatype: moviegraph
10/13/2023 16:53:26 - INFO -     <<< do_eval: True
10/13/2023 16:53:26 - INFO -     <<< do_lower_case: False
10/13/2023 16:53:26 - INFO -     <<< do_pretrain: False
10/13/2023 16:53:26 - INFO -     <<< do_train: False
10/13/2023 16:53:26 - INFO -     <<< epochs: 10
10/13/2023 16:53:26 - INFO -     <<< eval_frame_order: 0
10/13/2023 16:53:26 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 16:53:26 - INFO -     <<< feature_framerate: 1
10/13/2023 16:53:26 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 16:53:26 - INFO -     <<< fp16: False
10/13/2023 16:53:26 - INFO -     <<< fp16_opt_level: O1
10/13/2023 16:53:26 - INFO -     <<< freeze_layer_num: 0
10/13/2023 16:53:26 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 16:53:26 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 16:53:26 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 16:53:26 - INFO -     <<< linear_patch: 2d
10/13/2023 16:53:26 - INFO -     <<< local_rank: 0
10/13/2023 16:53:26 - INFO -     <<< loose_type: True
10/13/2023 16:53:26 - INFO -     <<< lr: 0.0001
10/13/2023 16:53:26 - INFO -     <<< lr_decay: 0.9
10/13/2023 16:53:26 - INFO -     <<< manipulation: temporal_int_mani
10/13/2023 16:53:26 - INFO -     <<< margin: 0.1
10/13/2023 16:53:26 - INFO -     <<< max_frames: 12
10/13/2023 16:53:26 - INFO -     <<< max_words: 60
10/13/2023 16:53:26 - INFO -     <<< n_display: 1
10/13/2023 16:53:26 - INFO -     <<< n_gpu: 1
10/13/2023 16:53:26 - INFO -     <<< n_pair: 1
10/13/2023 16:53:26 - INFO -     <<< negative_weighting: 1
10/13/2023 16:53:26 - INFO -     <<< num_thread_reader: 8
10/13/2023 16:53:26 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 16:53:26 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 16:53:26 - INFO -     <<< rank: 0
10/13/2023 16:53:26 - INFO -     <<< resume_model: None
10/13/2023 16:53:26 - INFO -     <<< sampled_use_mil: False
10/13/2023 16:53:26 - INFO -     <<< scale: 1
10/13/2023 16:53:26 - INFO -     <<< seed: 3
10/13/2023 16:53:26 - INFO -     <<< sim_header: seqTransf
10/13/2023 16:53:26 - INFO -     <<< slice_framepos: 2
10/13/2023 16:53:26 - INFO -     <<< task_type: retrieval
10/13/2023 16:53:26 - INFO -     <<< test_file: test_data_full/temporal_int_mani.csv
10/13/2023 16:53:26 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 16:53:26 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 16:53:26 - INFO -     <<< train_file: train2.csv
10/13/2023 16:53:26 - INFO -     <<< train_frame_order: 0
10/13/2023 16:53:26 - INFO -     <<< use_mil: False
10/13/2023 16:53:26 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 16:53:26 - INFO -     <<< val_file: test_data_full/temporal_int_mani.csv
10/13/2023 16:53:26 - INFO -     <<< video_dim: 1024
10/13/2023 16:53:26 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 16:53:26 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 16:53:26 - INFO -     <<< world_size: 1
10/13/2023 16:53:26 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 16:53:27 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 16:53:27 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 16:53:27 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 16:53:27 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 16:53:27 - WARNING -   Test retrieval by loose type.
10/13/2023 16:53:27 - WARNING -   	 embed_dim: 512
10/13/2023 16:53:27 - WARNING -   	 image_resolution: 224
10/13/2023 16:53:27 - WARNING -   	 vision_layers: 12
10/13/2023 16:53:27 - WARNING -   	 vision_width: 768
10/13/2023 16:53:27 - WARNING -   	 vision_patch_size: 32
10/13/2023 16:53:27 - WARNING -   	 context_length: 77
10/13/2023 16:53:27 - WARNING -   	 vocab_size: 49408
10/13/2023 16:53:27 - WARNING -   	 transformer_width: 512
10/13/2023 16:53:27 - WARNING -   	 transformer_heads: 8
10/13/2023 16:53:27 - WARNING -   	 transformer_layers: 12
10/13/2023 16:53:27 - WARNING -   		 linear_patch: 2d
10/13/2023 16:53:27 - WARNING -   	 cut_top_layer: 0
10/13/2023 16:53:28 - WARNING -   	 sim_header: seqTransf
10/13/2023 16:53:35 - INFO -   --------------------
10/13/2023 16:53:35 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 16:53:35 - INFO -   ***** Running test *****
10/13/2023 16:53:35 - INFO -     Num examples = 563
10/13/2023 16:53:35 - INFO -     Batch size = 1
10/13/2023 16:53:35 - INFO -     Num steps = 563
10/13/2023 16:53:35 - INFO -   ***** Running val *****
10/13/2023 16:53:35 - INFO -     Num examples = 563
10/13/2023 17:36:28 - INFO -   sim matrix size: 563, 563
10/13/2023 17:36:28 - INFO -   	 Length-T: 563, Length-V:563
10/13/2023 17:36:28 - INFO -   Text-to-Video:
10/13/2023 17:36:28 - INFO -   	>>>  R@1: 25.8 - R@5: 62.9 - R@10: 78.9 - Median R: 3.0 - Mean R: 10.0
10/13/2023 17:36:28 - INFO -   Video-to-Text:
10/13/2023 17:36:28 - INFO -   	>>>  V2T$R@1: 27.5 - V2T$R@5: 64.1 - V2T$R@10: 79.8 - V2T$Median R: 3.0 - V2T$Mean R: 8.9
10/13/2023 17:36:33 - INFO -   Effective parameters:
10/13/2023 17:36:33 - INFO -     <<< batch_size: 64
10/13/2023 17:36:33 - INFO -     <<< batch_size_val: 1
10/13/2023 17:36:33 - INFO -     <<< cache_dir: 
10/13/2023 17:36:33 - INFO -     <<< coef_lr: 0.001
10/13/2023 17:36:33 - INFO -     <<< cross_model: cross-base
10/13/2023 17:36:33 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 17:36:33 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 17:36:33 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 17:36:33 - INFO -     <<< datatype: moviegraph
10/13/2023 17:36:33 - INFO -     <<< do_eval: True
10/13/2023 17:36:33 - INFO -     <<< do_lower_case: False
10/13/2023 17:36:33 - INFO -     <<< do_pretrain: False
10/13/2023 17:36:33 - INFO -     <<< do_train: False
10/13/2023 17:36:33 - INFO -     <<< epochs: 10
10/13/2023 17:36:33 - INFO -     <<< eval_frame_order: 0
10/13/2023 17:36:33 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 17:36:33 - INFO -     <<< feature_framerate: 1
10/13/2023 17:36:33 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 17:36:33 - INFO -     <<< fp16: False
10/13/2023 17:36:33 - INFO -     <<< fp16_opt_level: O1
10/13/2023 17:36:33 - INFO -     <<< freeze_layer_num: 0
10/13/2023 17:36:33 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 17:36:33 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 17:36:33 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 17:36:33 - INFO -     <<< linear_patch: 2d
10/13/2023 17:36:33 - INFO -     <<< local_rank: 0
10/13/2023 17:36:33 - INFO -     <<< loose_type: True
10/13/2023 17:36:33 - INFO -     <<< lr: 0.0001
10/13/2023 17:36:33 - INFO -     <<< lr_decay: 0.9
10/13/2023 17:36:33 - INFO -     <<< manipulation: temporal_act
10/13/2023 17:36:33 - INFO -     <<< margin: 0.1
10/13/2023 17:36:33 - INFO -     <<< max_frames: 12
10/13/2023 17:36:33 - INFO -     <<< max_words: 60
10/13/2023 17:36:33 - INFO -     <<< n_display: 1
10/13/2023 17:36:33 - INFO -     <<< n_gpu: 1
10/13/2023 17:36:33 - INFO -     <<< n_pair: 1
10/13/2023 17:36:33 - INFO -     <<< negative_weighting: 1
10/13/2023 17:36:33 - INFO -     <<< num_thread_reader: 8
10/13/2023 17:36:33 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 17:36:33 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 17:36:33 - INFO -     <<< rank: 0
10/13/2023 17:36:33 - INFO -     <<< resume_model: None
10/13/2023 17:36:33 - INFO -     <<< sampled_use_mil: False
10/13/2023 17:36:33 - INFO -     <<< scale: 0
10/13/2023 17:36:33 - INFO -     <<< seed: 3
10/13/2023 17:36:33 - INFO -     <<< sim_header: seqTransf
10/13/2023 17:36:33 - INFO -     <<< slice_framepos: 2
10/13/2023 17:36:33 - INFO -     <<< task_type: retrieval
10/13/2023 17:36:33 - INFO -     <<< test_file: test_data_full/temporal_act.csv
10/13/2023 17:36:33 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 17:36:33 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 17:36:33 - INFO -     <<< train_file: train2.csv
10/13/2023 17:36:33 - INFO -     <<< train_frame_order: 0
10/13/2023 17:36:33 - INFO -     <<< use_mil: False
10/13/2023 17:36:33 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 17:36:33 - INFO -     <<< val_file: test_data_full/temporal_act.csv
10/13/2023 17:36:33 - INFO -     <<< video_dim: 1024
10/13/2023 17:36:33 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 17:36:33 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 17:36:33 - INFO -     <<< world_size: 1
10/13/2023 17:36:33 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 17:36:34 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 17:36:34 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 17:36:34 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 17:36:34 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 17:36:34 - WARNING -   Test retrieval by loose type.
10/13/2023 17:36:34 - WARNING -   	 embed_dim: 512
10/13/2023 17:36:34 - WARNING -   	 image_resolution: 224
10/13/2023 17:36:34 - WARNING -   	 vision_layers: 12
10/13/2023 17:36:34 - WARNING -   	 vision_width: 768
10/13/2023 17:36:34 - WARNING -   	 vision_patch_size: 32
10/13/2023 17:36:34 - WARNING -   	 context_length: 77
10/13/2023 17:36:34 - WARNING -   	 vocab_size: 49408
10/13/2023 17:36:34 - WARNING -   	 transformer_width: 512
10/13/2023 17:36:34 - WARNING -   	 transformer_heads: 8
10/13/2023 17:36:34 - WARNING -   	 transformer_layers: 12
10/13/2023 17:36:34 - WARNING -   		 linear_patch: 2d
10/13/2023 17:36:34 - WARNING -   	 cut_top_layer: 0
10/13/2023 17:36:36 - WARNING -   	 sim_header: seqTransf
10/13/2023 17:36:42 - INFO -   --------------------
10/13/2023 17:36:42 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 17:36:42 - INFO -   ***** Running test *****
10/13/2023 17:36:42 - INFO -     Num examples = 489
10/13/2023 17:36:42 - INFO -     Batch size = 1
10/13/2023 17:36:42 - INFO -     Num steps = 489
10/13/2023 17:36:42 - INFO -   ***** Running val *****
10/13/2023 17:36:42 - INFO -     Num examples = 489
10/13/2023 18:10:31 - INFO -   sim matrix size: 489, 489
10/13/2023 18:10:31 - INFO -   	 Length-T: 489, Length-V:489
10/13/2023 18:10:31 - INFO -   Text-to-Video:
10/13/2023 18:10:31 - INFO -   	>>>  R@1: 38.9 - R@5: 75.3 - R@10: 83.8 - Median R: 2.0 - Mean R: 6.7
10/13/2023 18:10:31 - INFO -   Video-to-Text:
10/13/2023 18:10:31 - INFO -   	>>>  V2T$R@1: 38.7 - V2T$R@5: 74.2 - V2T$R@10: 86.9 - V2T$Median R: 2.0 - V2T$Mean R: 6.5
10/13/2023 18:10:36 - INFO -   Effective parameters:
10/13/2023 18:10:36 - INFO -     <<< batch_size: 64
10/13/2023 18:10:36 - INFO -     <<< batch_size_val: 1
10/13/2023 18:10:36 - INFO -     <<< cache_dir: 
10/13/2023 18:10:36 - INFO -     <<< coef_lr: 0.001
10/13/2023 18:10:36 - INFO -     <<< cross_model: cross-base
10/13/2023 18:10:36 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 18:10:36 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 18:10:36 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 18:10:36 - INFO -     <<< datatype: moviegraph
10/13/2023 18:10:36 - INFO -     <<< do_eval: True
10/13/2023 18:10:36 - INFO -     <<< do_lower_case: False
10/13/2023 18:10:36 - INFO -     <<< do_pretrain: False
10/13/2023 18:10:36 - INFO -     <<< do_train: False
10/13/2023 18:10:36 - INFO -     <<< epochs: 10
10/13/2023 18:10:36 - INFO -     <<< eval_frame_order: 0
10/13/2023 18:10:36 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 18:10:36 - INFO -     <<< feature_framerate: 1
10/13/2023 18:10:36 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 18:10:36 - INFO -     <<< fp16: False
10/13/2023 18:10:36 - INFO -     <<< fp16_opt_level: O1
10/13/2023 18:10:36 - INFO -     <<< freeze_layer_num: 0
10/13/2023 18:10:36 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 18:10:36 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 18:10:36 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 18:10:36 - INFO -     <<< linear_patch: 2d
10/13/2023 18:10:36 - INFO -     <<< local_rank: 0
10/13/2023 18:10:36 - INFO -     <<< loose_type: True
10/13/2023 18:10:36 - INFO -     <<< lr: 0.0001
10/13/2023 18:10:36 - INFO -     <<< lr_decay: 0.9
10/13/2023 18:10:36 - INFO -     <<< manipulation: temporal_act_mani
10/13/2023 18:10:36 - INFO -     <<< margin: 0.1
10/13/2023 18:10:36 - INFO -     <<< max_frames: 12
10/13/2023 18:10:36 - INFO -     <<< max_words: 60
10/13/2023 18:10:36 - INFO -     <<< n_display: 1
10/13/2023 18:10:36 - INFO -     <<< n_gpu: 1
10/13/2023 18:10:36 - INFO -     <<< n_pair: 1
10/13/2023 18:10:36 - INFO -     <<< negative_weighting: 1
10/13/2023 18:10:36 - INFO -     <<< num_thread_reader: 8
10/13/2023 18:10:36 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 18:10:36 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 18:10:36 - INFO -     <<< rank: 0
10/13/2023 18:10:36 - INFO -     <<< resume_model: None
10/13/2023 18:10:36 - INFO -     <<< sampled_use_mil: False
10/13/2023 18:10:36 - INFO -     <<< scale: 1
10/13/2023 18:10:36 - INFO -     <<< seed: 3
10/13/2023 18:10:36 - INFO -     <<< sim_header: seqTransf
10/13/2023 18:10:36 - INFO -     <<< slice_framepos: 2
10/13/2023 18:10:36 - INFO -     <<< task_type: retrieval
10/13/2023 18:10:36 - INFO -     <<< test_file: test_data_full/temporal_act_mani.csv
10/13/2023 18:10:36 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 18:10:36 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 18:10:36 - INFO -     <<< train_file: train2.csv
10/13/2023 18:10:36 - INFO -     <<< train_frame_order: 0
10/13/2023 18:10:36 - INFO -     <<< use_mil: False
10/13/2023 18:10:36 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 18:10:36 - INFO -     <<< val_file: test_data_full/temporal_act_mani.csv
10/13/2023 18:10:36 - INFO -     <<< video_dim: 1024
10/13/2023 18:10:36 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 18:10:36 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 18:10:36 - INFO -     <<< world_size: 1
10/13/2023 18:10:36 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 18:10:37 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 18:10:37 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 18:10:37 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 18:10:37 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 18:10:37 - WARNING -   Test retrieval by loose type.
10/13/2023 18:10:37 - WARNING -   	 embed_dim: 512
10/13/2023 18:10:37 - WARNING -   	 image_resolution: 224
10/13/2023 18:10:37 - WARNING -   	 vision_layers: 12
10/13/2023 18:10:37 - WARNING -   	 vision_width: 768
10/13/2023 18:10:37 - WARNING -   	 vision_patch_size: 32
10/13/2023 18:10:37 - WARNING -   	 context_length: 77
10/13/2023 18:10:37 - WARNING -   	 vocab_size: 49408
10/13/2023 18:10:37 - WARNING -   	 transformer_width: 512
10/13/2023 18:10:37 - WARNING -   	 transformer_heads: 8
10/13/2023 18:10:37 - WARNING -   	 transformer_layers: 12
10/13/2023 18:10:37 - WARNING -   		 linear_patch: 2d
10/13/2023 18:10:37 - WARNING -   	 cut_top_layer: 0
10/13/2023 18:10:39 - WARNING -   	 sim_header: seqTransf
10/13/2023 18:10:45 - INFO -   --------------------
10/13/2023 18:10:45 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 18:10:45 - INFO -   ***** Running test *****
10/13/2023 18:10:45 - INFO -     Num examples = 489
10/13/2023 18:10:45 - INFO -     Batch size = 1
10/13/2023 18:10:45 - INFO -     Num steps = 489
10/13/2023 18:10:45 - INFO -   ***** Running val *****
10/13/2023 18:10:45 - INFO -     Num examples = 489
10/13/2023 18:46:01 - INFO -   sim matrix size: 489, 489
10/13/2023 18:46:01 - INFO -   	 Length-T: 489, Length-V:489
10/13/2023 18:46:01 - INFO -   Text-to-Video:
10/13/2023 18:46:01 - INFO -   	>>>  R@1: 39.9 - R@5: 74.4 - R@10: 83.8 - Median R: 2.0 - Mean R: 6.6
10/13/2023 18:46:01 - INFO -   Video-to-Text:
10/13/2023 18:46:01 - INFO -   	>>>  V2T$R@1: 39.1 - V2T$R@5: 74.8 - V2T$R@10: 86.7 - V2T$Median R: 2.0 - V2T$Mean R: 6.5
10/13/2023 18:46:07 - INFO -   Effective parameters:
10/13/2023 18:46:07 - INFO -     <<< batch_size: 64
10/13/2023 18:46:07 - INFO -     <<< batch_size_val: 1
10/13/2023 18:46:07 - INFO -     <<< cache_dir: 
10/13/2023 18:46:07 - INFO -     <<< coef_lr: 0.001
10/13/2023 18:46:07 - INFO -     <<< cross_model: cross-base
10/13/2023 18:46:07 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 18:46:07 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 18:46:07 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 18:46:07 - INFO -     <<< datatype: moviegraph
10/13/2023 18:46:07 - INFO -     <<< do_eval: True
10/13/2023 18:46:07 - INFO -     <<< do_lower_case: False
10/13/2023 18:46:07 - INFO -     <<< do_pretrain: False
10/13/2023 18:46:07 - INFO -     <<< do_train: False
10/13/2023 18:46:07 - INFO -     <<< epochs: 10
10/13/2023 18:46:07 - INFO -     <<< eval_frame_order: 0
10/13/2023 18:46:07 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 18:46:07 - INFO -     <<< feature_framerate: 1
10/13/2023 18:46:07 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 18:46:07 - INFO -     <<< fp16: False
10/13/2023 18:46:07 - INFO -     <<< fp16_opt_level: O1
10/13/2023 18:46:07 - INFO -     <<< freeze_layer_num: 0
10/13/2023 18:46:07 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 18:46:07 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 18:46:07 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 18:46:07 - INFO -     <<< linear_patch: 2d
10/13/2023 18:46:07 - INFO -     <<< local_rank: 0
10/13/2023 18:46:07 - INFO -     <<< loose_type: True
10/13/2023 18:46:07 - INFO -     <<< lr: 0.0001
10/13/2023 18:46:07 - INFO -     <<< lr_decay: 0.9
10/13/2023 18:46:07 - INFO -     <<< manipulation: neighborhood_same_entity
10/13/2023 18:46:07 - INFO -     <<< margin: 0.1
10/13/2023 18:46:07 - INFO -     <<< max_frames: 12
10/13/2023 18:46:07 - INFO -     <<< max_words: 60
10/13/2023 18:46:07 - INFO -     <<< n_display: 1
10/13/2023 18:46:07 - INFO -     <<< n_gpu: 1
10/13/2023 18:46:07 - INFO -     <<< n_pair: 1
10/13/2023 18:46:07 - INFO -     <<< negative_weighting: 1
10/13/2023 18:46:07 - INFO -     <<< num_thread_reader: 8
10/13/2023 18:46:07 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 18:46:07 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 18:46:07 - INFO -     <<< rank: 0
10/13/2023 18:46:07 - INFO -     <<< resume_model: None
10/13/2023 18:46:07 - INFO -     <<< sampled_use_mil: False
10/13/2023 18:46:07 - INFO -     <<< scale: 0
10/13/2023 18:46:07 - INFO -     <<< seed: 3
10/13/2023 18:46:07 - INFO -     <<< sim_header: seqTransf
10/13/2023 18:46:07 - INFO -     <<< slice_framepos: 2
10/13/2023 18:46:07 - INFO -     <<< task_type: retrieval
10/13/2023 18:46:07 - INFO -     <<< test_file: test_data_full/neighborhood_same_entity.csv
10/13/2023 18:46:07 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 18:46:07 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 18:46:07 - INFO -     <<< train_file: train2.csv
10/13/2023 18:46:07 - INFO -     <<< train_frame_order: 0
10/13/2023 18:46:07 - INFO -     <<< use_mil: False
10/13/2023 18:46:07 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 18:46:07 - INFO -     <<< val_file: test_data_full/neighborhood_same_entity.csv
10/13/2023 18:46:07 - INFO -     <<< video_dim: 1024
10/13/2023 18:46:07 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 18:46:07 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 18:46:07 - INFO -     <<< world_size: 1
10/13/2023 18:46:07 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 18:46:08 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 18:46:08 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 18:46:08 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 18:46:08 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 18:46:08 - WARNING -   Test retrieval by loose type.
10/13/2023 18:46:08 - WARNING -   	 embed_dim: 512
10/13/2023 18:46:08 - WARNING -   	 image_resolution: 224
10/13/2023 18:46:08 - WARNING -   	 vision_layers: 12
10/13/2023 18:46:08 - WARNING -   	 vision_width: 768
10/13/2023 18:46:08 - WARNING -   	 vision_patch_size: 32
10/13/2023 18:46:08 - WARNING -   	 context_length: 77
10/13/2023 18:46:08 - WARNING -   	 vocab_size: 49408
10/13/2023 18:46:08 - WARNING -   	 transformer_width: 512
10/13/2023 18:46:08 - WARNING -   	 transformer_heads: 8
10/13/2023 18:46:08 - WARNING -   	 transformer_layers: 12
10/13/2023 18:46:08 - WARNING -   		 linear_patch: 2d
10/13/2023 18:46:08 - WARNING -   	 cut_top_layer: 0
10/13/2023 18:46:09 - WARNING -   	 sim_header: seqTransf
10/13/2023 18:46:16 - INFO -   --------------------
10/13/2023 18:46:16 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 18:46:16 - INFO -   ***** Running test *****
10/13/2023 18:46:16 - INFO -     Num examples = 160
10/13/2023 18:46:16 - INFO -     Batch size = 1
10/13/2023 18:46:16 - INFO -     Num steps = 160
10/13/2023 18:46:16 - INFO -   ***** Running val *****
10/13/2023 18:46:16 - INFO -     Num examples = 160
10/13/2023 18:52:45 - INFO -   sim matrix size: 160, 160
10/13/2023 18:52:45 - INFO -   	 Length-T: 160, Length-V:160
10/13/2023 18:52:45 - INFO -   Text-to-Video:
10/13/2023 18:52:45 - INFO -   	>>>  R@1: 20.0 - R@5: 48.1 - R@10: 66.2 - Median R: 6.0 - Mean R: 12.5
10/13/2023 18:52:45 - INFO -   Video-to-Text:
10/13/2023 18:52:45 - INFO -   	>>>  V2T$R@1: 22.6 - V2T$R@5: 48.2 - V2T$R@10: 66.5 - V2T$Median R: 6.0 - V2T$Mean R: 10.7
10/13/2023 18:52:50 - INFO -   Effective parameters:
10/13/2023 18:52:50 - INFO -     <<< batch_size: 64
10/13/2023 18:52:50 - INFO -     <<< batch_size_val: 1
10/13/2023 18:52:50 - INFO -     <<< cache_dir: 
10/13/2023 18:52:50 - INFO -     <<< coef_lr: 0.001
10/13/2023 18:52:50 - INFO -     <<< cross_model: cross-base
10/13/2023 18:52:50 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 18:52:50 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 18:52:50 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 18:52:50 - INFO -     <<< datatype: moviegraph
10/13/2023 18:52:50 - INFO -     <<< do_eval: True
10/13/2023 18:52:50 - INFO -     <<< do_lower_case: False
10/13/2023 18:52:50 - INFO -     <<< do_pretrain: False
10/13/2023 18:52:50 - INFO -     <<< do_train: False
10/13/2023 18:52:50 - INFO -     <<< epochs: 10
10/13/2023 18:52:50 - INFO -     <<< eval_frame_order: 0
10/13/2023 18:52:50 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 18:52:50 - INFO -     <<< feature_framerate: 1
10/13/2023 18:52:50 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 18:52:50 - INFO -     <<< fp16: False
10/13/2023 18:52:50 - INFO -     <<< fp16_opt_level: O1
10/13/2023 18:52:50 - INFO -     <<< freeze_layer_num: 0
10/13/2023 18:52:50 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 18:52:50 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 18:52:50 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 18:52:50 - INFO -     <<< linear_patch: 2d
10/13/2023 18:52:50 - INFO -     <<< local_rank: 0
10/13/2023 18:52:50 - INFO -     <<< loose_type: True
10/13/2023 18:52:50 - INFO -     <<< lr: 0.0001
10/13/2023 18:52:50 - INFO -     <<< lr_decay: 0.9
10/13/2023 18:52:50 - INFO -     <<< manipulation: neighborhood_same_entity_mani
10/13/2023 18:52:50 - INFO -     <<< margin: 0.1
10/13/2023 18:52:50 - INFO -     <<< max_frames: 12
10/13/2023 18:52:50 - INFO -     <<< max_words: 60
10/13/2023 18:52:50 - INFO -     <<< n_display: 1
10/13/2023 18:52:50 - INFO -     <<< n_gpu: 1
10/13/2023 18:52:50 - INFO -     <<< n_pair: 1
10/13/2023 18:52:50 - INFO -     <<< negative_weighting: 1
10/13/2023 18:52:50 - INFO -     <<< num_thread_reader: 8
10/13/2023 18:52:50 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 18:52:50 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 18:52:50 - INFO -     <<< rank: 0
10/13/2023 18:52:50 - INFO -     <<< resume_model: None
10/13/2023 18:52:50 - INFO -     <<< sampled_use_mil: False
10/13/2023 18:52:50 - INFO -     <<< scale: 1
10/13/2023 18:52:50 - INFO -     <<< seed: 3
10/13/2023 18:52:50 - INFO -     <<< sim_header: seqTransf
10/13/2023 18:52:50 - INFO -     <<< slice_framepos: 2
10/13/2023 18:52:50 - INFO -     <<< task_type: retrieval
10/13/2023 18:52:50 - INFO -     <<< test_file: test_data_full/neighborhood_same_entity_mani.csv
10/13/2023 18:52:50 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 18:52:50 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 18:52:50 - INFO -     <<< train_file: train2.csv
10/13/2023 18:52:50 - INFO -     <<< train_frame_order: 0
10/13/2023 18:52:50 - INFO -     <<< use_mil: False
10/13/2023 18:52:50 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 18:52:50 - INFO -     <<< val_file: test_data_full/neighborhood_same_entity_mani.csv
10/13/2023 18:52:50 - INFO -     <<< video_dim: 1024
10/13/2023 18:52:50 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 18:52:50 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 18:52:50 - INFO -     <<< world_size: 1
10/13/2023 18:52:50 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 18:52:51 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 18:52:51 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 18:52:51 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 18:52:51 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 18:52:51 - WARNING -   Test retrieval by loose type.
10/13/2023 18:52:51 - WARNING -   	 embed_dim: 512
10/13/2023 18:52:51 - WARNING -   	 image_resolution: 224
10/13/2023 18:52:51 - WARNING -   	 vision_layers: 12
10/13/2023 18:52:51 - WARNING -   	 vision_width: 768
10/13/2023 18:52:51 - WARNING -   	 vision_patch_size: 32
10/13/2023 18:52:51 - WARNING -   	 context_length: 77
10/13/2023 18:52:51 - WARNING -   	 vocab_size: 49408
10/13/2023 18:52:51 - WARNING -   	 transformer_width: 512
10/13/2023 18:52:51 - WARNING -   	 transformer_heads: 8
10/13/2023 18:52:51 - WARNING -   	 transformer_layers: 12
10/13/2023 18:52:51 - WARNING -   		 linear_patch: 2d
10/13/2023 18:52:51 - WARNING -   	 cut_top_layer: 0
10/13/2023 18:52:53 - WARNING -   	 sim_header: seqTransf
10/13/2023 18:52:59 - INFO -   --------------------
10/13/2023 18:52:59 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 18:52:59 - INFO -   ***** Running test *****
10/13/2023 18:52:59 - INFO -     Num examples = 160
10/13/2023 18:52:59 - INFO -     Batch size = 1
10/13/2023 18:52:59 - INFO -     Num steps = 160
10/13/2023 18:52:59 - INFO -   ***** Running val *****
10/13/2023 18:52:59 - INFO -     Num examples = 160
10/13/2023 18:59:28 - INFO -   sim matrix size: 160, 160
10/13/2023 18:59:28 - INFO -   	 Length-T: 160, Length-V:160
10/13/2023 18:59:28 - INFO -   Text-to-Video:
10/13/2023 18:59:28 - INFO -   	>>>  R@1: 21.9 - R@5: 45.6 - R@10: 63.1 - Median R: 7.0 - Mean R: 12.7
10/13/2023 18:59:28 - INFO -   Video-to-Text:
10/13/2023 18:59:28 - INFO -   	>>>  V2T$R@1: 20.7 - V2T$R@5: 42.7 - V2T$R@10: 63.4 - V2T$Median R: 7.0 - V2T$Mean R: 10.6
10/13/2023 18:59:34 - INFO -   Effective parameters:
10/13/2023 18:59:34 - INFO -     <<< batch_size: 64
10/13/2023 18:59:34 - INFO -     <<< batch_size_val: 1
10/13/2023 18:59:34 - INFO -     <<< cache_dir: 
10/13/2023 18:59:34 - INFO -     <<< coef_lr: 0.001
10/13/2023 18:59:34 - INFO -     <<< cross_model: cross-base
10/13/2023 18:59:34 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 18:59:34 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 18:59:34 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 18:59:34 - INFO -     <<< datatype: moviegraph
10/13/2023 18:59:34 - INFO -     <<< do_eval: True
10/13/2023 18:59:34 - INFO -     <<< do_lower_case: False
10/13/2023 18:59:34 - INFO -     <<< do_pretrain: False
10/13/2023 18:59:34 - INFO -     <<< do_train: False
10/13/2023 18:59:34 - INFO -     <<< epochs: 10
10/13/2023 18:59:34 - INFO -     <<< eval_frame_order: 0
10/13/2023 18:59:34 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 18:59:34 - INFO -     <<< feature_framerate: 1
10/13/2023 18:59:34 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 18:59:34 - INFO -     <<< fp16: False
10/13/2023 18:59:34 - INFO -     <<< fp16_opt_level: O1
10/13/2023 18:59:34 - INFO -     <<< freeze_layer_num: 0
10/13/2023 18:59:34 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 18:59:34 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 18:59:34 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 18:59:34 - INFO -     <<< linear_patch: 2d
10/13/2023 18:59:34 - INFO -     <<< local_rank: 0
10/13/2023 18:59:34 - INFO -     <<< loose_type: True
10/13/2023 18:59:34 - INFO -     <<< lr: 0.0001
10/13/2023 18:59:34 - INFO -     <<< lr_decay: 0.9
10/13/2023 18:59:34 - INFO -     <<< manipulation: neighborhood_diff_entity
10/13/2023 18:59:34 - INFO -     <<< margin: 0.1
10/13/2023 18:59:34 - INFO -     <<< max_frames: 12
10/13/2023 18:59:34 - INFO -     <<< max_words: 60
10/13/2023 18:59:34 - INFO -     <<< n_display: 1
10/13/2023 18:59:34 - INFO -     <<< n_gpu: 1
10/13/2023 18:59:34 - INFO -     <<< n_pair: 1
10/13/2023 18:59:34 - INFO -     <<< negative_weighting: 1
10/13/2023 18:59:34 - INFO -     <<< num_thread_reader: 8
10/13/2023 18:59:34 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 18:59:34 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 18:59:34 - INFO -     <<< rank: 0
10/13/2023 18:59:34 - INFO -     <<< resume_model: None
10/13/2023 18:59:34 - INFO -     <<< sampled_use_mil: False
10/13/2023 18:59:34 - INFO -     <<< scale: 0
10/13/2023 18:59:34 - INFO -     <<< seed: 3
10/13/2023 18:59:34 - INFO -     <<< sim_header: seqTransf
10/13/2023 18:59:34 - INFO -     <<< slice_framepos: 2
10/13/2023 18:59:34 - INFO -     <<< task_type: retrieval
10/13/2023 18:59:34 - INFO -     <<< test_file: test_data_full/neighborhood_diff_entity.csv
10/13/2023 18:59:34 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 18:59:34 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 18:59:34 - INFO -     <<< train_file: train2.csv
10/13/2023 18:59:34 - INFO -     <<< train_frame_order: 0
10/13/2023 18:59:34 - INFO -     <<< use_mil: False
10/13/2023 18:59:34 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 18:59:34 - INFO -     <<< val_file: test_data_full/neighborhood_diff_entity.csv
10/13/2023 18:59:34 - INFO -     <<< video_dim: 1024
10/13/2023 18:59:34 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 18:59:34 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 18:59:34 - INFO -     <<< world_size: 1
10/13/2023 18:59:34 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 18:59:34 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 18:59:34 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 18:59:34 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 18:59:34 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 18:59:34 - WARNING -   Test retrieval by loose type.
10/13/2023 18:59:34 - WARNING -   	 embed_dim: 512
10/13/2023 18:59:34 - WARNING -   	 image_resolution: 224
10/13/2023 18:59:34 - WARNING -   	 vision_layers: 12
10/13/2023 18:59:34 - WARNING -   	 vision_width: 768
10/13/2023 18:59:34 - WARNING -   	 vision_patch_size: 32
10/13/2023 18:59:34 - WARNING -   	 context_length: 77
10/13/2023 18:59:34 - WARNING -   	 vocab_size: 49408
10/13/2023 18:59:34 - WARNING -   	 transformer_width: 512
10/13/2023 18:59:34 - WARNING -   	 transformer_heads: 8
10/13/2023 18:59:34 - WARNING -   	 transformer_layers: 12
10/13/2023 18:59:34 - WARNING -   		 linear_patch: 2d
10/13/2023 18:59:34 - WARNING -   	 cut_top_layer: 0
10/13/2023 18:59:36 - WARNING -   	 sim_header: seqTransf
10/13/2023 18:59:43 - INFO -   --------------------
10/13/2023 18:59:43 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 18:59:43 - INFO -   ***** Running test *****
10/13/2023 18:59:43 - INFO -     Num examples = 597
10/13/2023 18:59:43 - INFO -     Batch size = 1
10/13/2023 18:59:43 - INFO -     Num steps = 597
10/13/2023 18:59:43 - INFO -   ***** Running val *****
10/13/2023 18:59:43 - INFO -     Num examples = 597
10/13/2023 19:45:50 - INFO -   sim matrix size: 597, 597
10/13/2023 19:45:50 - INFO -   	 Length-T: 597, Length-V:597
10/13/2023 19:45:50 - INFO -   Text-to-Video:
10/13/2023 19:45:50 - INFO -   	>>>  R@1: 20.4 - R@5: 54.3 - R@10: 71.5 - Median R: 5.0 - Mean R: 11.9
10/13/2023 19:45:50 - INFO -   Video-to-Text:
10/13/2023 19:45:50 - INFO -   	>>>  V2T$R@1: 9.3 - V2T$R@5: 34.9 - V2T$R@10: 57.8 - V2T$Median R: 9.0 - V2T$Mean R: 14.8
10/13/2023 19:45:56 - INFO -   Effective parameters:
10/13/2023 19:45:56 - INFO -     <<< batch_size: 64
10/13/2023 19:45:56 - INFO -     <<< batch_size_val: 1
10/13/2023 19:45:56 - INFO -     <<< cache_dir: 
10/13/2023 19:45:56 - INFO -     <<< coef_lr: 0.001
10/13/2023 19:45:56 - INFO -     <<< cross_model: cross-base
10/13/2023 19:45:56 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 19:45:56 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 19:45:56 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 19:45:56 - INFO -     <<< datatype: moviegraph
10/13/2023 19:45:56 - INFO -     <<< do_eval: True
10/13/2023 19:45:56 - INFO -     <<< do_lower_case: False
10/13/2023 19:45:56 - INFO -     <<< do_pretrain: False
10/13/2023 19:45:56 - INFO -     <<< do_train: False
10/13/2023 19:45:56 - INFO -     <<< epochs: 10
10/13/2023 19:45:56 - INFO -     <<< eval_frame_order: 0
10/13/2023 19:45:56 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 19:45:56 - INFO -     <<< feature_framerate: 1
10/13/2023 19:45:56 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 19:45:56 - INFO -     <<< fp16: False
10/13/2023 19:45:56 - INFO -     <<< fp16_opt_level: O1
10/13/2023 19:45:56 - INFO -     <<< freeze_layer_num: 0
10/13/2023 19:45:56 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 19:45:56 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 19:45:56 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 19:45:56 - INFO -     <<< linear_patch: 2d
10/13/2023 19:45:56 - INFO -     <<< local_rank: 0
10/13/2023 19:45:56 - INFO -     <<< loose_type: True
10/13/2023 19:45:56 - INFO -     <<< lr: 0.0001
10/13/2023 19:45:56 - INFO -     <<< lr_decay: 0.9
10/13/2023 19:45:56 - INFO -     <<< manipulation: neighborhood_diff_entity_mani
10/13/2023 19:45:56 - INFO -     <<< margin: 0.1
10/13/2023 19:45:56 - INFO -     <<< max_frames: 12
10/13/2023 19:45:56 - INFO -     <<< max_words: 60
10/13/2023 19:45:56 - INFO -     <<< n_display: 1
10/13/2023 19:45:56 - INFO -     <<< n_gpu: 1
10/13/2023 19:45:56 - INFO -     <<< n_pair: 1
10/13/2023 19:45:56 - INFO -     <<< negative_weighting: 1
10/13/2023 19:45:56 - INFO -     <<< num_thread_reader: 8
10/13/2023 19:45:56 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 19:45:56 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 19:45:56 - INFO -     <<< rank: 0
10/13/2023 19:45:56 - INFO -     <<< resume_model: None
10/13/2023 19:45:56 - INFO -     <<< sampled_use_mil: False
10/13/2023 19:45:56 - INFO -     <<< scale: 1
10/13/2023 19:45:56 - INFO -     <<< seed: 3
10/13/2023 19:45:56 - INFO -     <<< sim_header: seqTransf
10/13/2023 19:45:56 - INFO -     <<< slice_framepos: 2
10/13/2023 19:45:56 - INFO -     <<< task_type: retrieval
10/13/2023 19:45:56 - INFO -     <<< test_file: test_data_full/neighborhood_diff_entity_mani.csv
10/13/2023 19:45:56 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 19:45:56 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 19:45:56 - INFO -     <<< train_file: train2.csv
10/13/2023 19:45:56 - INFO -     <<< train_frame_order: 0
10/13/2023 19:45:56 - INFO -     <<< use_mil: False
10/13/2023 19:45:56 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 19:45:56 - INFO -     <<< val_file: test_data_full/neighborhood_diff_entity_mani.csv
10/13/2023 19:45:56 - INFO -     <<< video_dim: 1024
10/13/2023 19:45:56 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 19:45:56 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 19:45:56 - INFO -     <<< world_size: 1
10/13/2023 19:45:56 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 19:45:56 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 19:45:56 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 19:45:56 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 19:45:56 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 19:45:56 - WARNING -   Test retrieval by loose type.
10/13/2023 19:45:56 - WARNING -   	 embed_dim: 512
10/13/2023 19:45:56 - WARNING -   	 image_resolution: 224
10/13/2023 19:45:56 - WARNING -   	 vision_layers: 12
10/13/2023 19:45:56 - WARNING -   	 vision_width: 768
10/13/2023 19:45:56 - WARNING -   	 vision_patch_size: 32
10/13/2023 19:45:56 - WARNING -   	 context_length: 77
10/13/2023 19:45:56 - WARNING -   	 vocab_size: 49408
10/13/2023 19:45:56 - WARNING -   	 transformer_width: 512
10/13/2023 19:45:56 - WARNING -   	 transformer_heads: 8
10/13/2023 19:45:56 - WARNING -   	 transformer_layers: 12
10/13/2023 19:45:56 - WARNING -   		 linear_patch: 2d
10/13/2023 19:45:56 - WARNING -   	 cut_top_layer: 0
10/13/2023 19:45:58 - WARNING -   	 sim_header: seqTransf
10/13/2023 19:46:04 - INFO -   --------------------
10/13/2023 19:46:04 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 19:46:05 - INFO -   ***** Running test *****
10/13/2023 19:46:05 - INFO -     Num examples = 597
10/13/2023 19:46:05 - INFO -     Batch size = 1
10/13/2023 19:46:05 - INFO -     Num steps = 597
10/13/2023 19:46:05 - INFO -   ***** Running val *****
10/13/2023 19:46:05 - INFO -     Num examples = 597
10/13/2023 20:32:58 - INFO -   sim matrix size: 597, 597
10/13/2023 20:32:58 - INFO -   	 Length-T: 597, Length-V:597
10/13/2023 20:32:58 - INFO -   Text-to-Video:
10/13/2023 20:32:58 - INFO -   	>>>  R@1: 20.9 - R@5: 53.9 - R@10: 71.4 - Median R: 5.0 - Mean R: 12.1
10/13/2023 20:32:58 - INFO -   Video-to-Text:
10/13/2023 20:32:58 - INFO -   	>>>  V2T$R@1: 9.9 - V2T$R@5: 37.1 - V2T$R@10: 60.3 - V2T$Median R: 8.0 - V2T$Mean R: 15.2
10/13/2023 20:33:04 - INFO -   Effective parameters:
10/13/2023 20:33:04 - INFO -     <<< batch_size: 64
10/13/2023 20:33:04 - INFO -     <<< batch_size_val: 1
10/13/2023 20:33:04 - INFO -     <<< cache_dir: 
10/13/2023 20:33:04 - INFO -     <<< coef_lr: 0.001
10/13/2023 20:33:04 - INFO -     <<< cross_model: cross-base
10/13/2023 20:33:04 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 20:33:04 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 20:33:04 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 20:33:04 - INFO -     <<< datatype: moviegraph
10/13/2023 20:33:04 - INFO -     <<< do_eval: True
10/13/2023 20:33:04 - INFO -     <<< do_lower_case: False
10/13/2023 20:33:04 - INFO -     <<< do_pretrain: False
10/13/2023 20:33:04 - INFO -     <<< do_train: False
10/13/2023 20:33:04 - INFO -     <<< epochs: 10
10/13/2023 20:33:04 - INFO -     <<< eval_frame_order: 0
10/13/2023 20:33:04 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 20:33:04 - INFO -     <<< feature_framerate: 1
10/13/2023 20:33:04 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 20:33:04 - INFO -     <<< fp16: False
10/13/2023 20:33:04 - INFO -     <<< fp16_opt_level: O1
10/13/2023 20:33:04 - INFO -     <<< freeze_layer_num: 0
10/13/2023 20:33:04 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 20:33:04 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 20:33:04 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 20:33:04 - INFO -     <<< linear_patch: 2d
10/13/2023 20:33:04 - INFO -     <<< local_rank: 0
10/13/2023 20:33:04 - INFO -     <<< loose_type: True
10/13/2023 20:33:04 - INFO -     <<< lr: 0.0001
10/13/2023 20:33:04 - INFO -     <<< lr_decay: 0.9
10/13/2023 20:33:04 - INFO -     <<< manipulation: counter_rel
10/13/2023 20:33:04 - INFO -     <<< margin: 0.1
10/13/2023 20:33:04 - INFO -     <<< max_frames: 12
10/13/2023 20:33:04 - INFO -     <<< max_words: 60
10/13/2023 20:33:04 - INFO -     <<< n_display: 1
10/13/2023 20:33:04 - INFO -     <<< n_gpu: 1
10/13/2023 20:33:04 - INFO -     <<< n_pair: 1
10/13/2023 20:33:04 - INFO -     <<< negative_weighting: 1
10/13/2023 20:33:04 - INFO -     <<< num_thread_reader: 8
10/13/2023 20:33:04 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 20:33:04 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 20:33:04 - INFO -     <<< rank: 0
10/13/2023 20:33:04 - INFO -     <<< resume_model: None
10/13/2023 20:33:04 - INFO -     <<< sampled_use_mil: False
10/13/2023 20:33:04 - INFO -     <<< scale: 0
10/13/2023 20:33:04 - INFO -     <<< seed: 3
10/13/2023 20:33:04 - INFO -     <<< sim_header: seqTransf
10/13/2023 20:33:04 - INFO -     <<< slice_framepos: 2
10/13/2023 20:33:04 - INFO -     <<< task_type: retrieval
10/13/2023 20:33:04 - INFO -     <<< test_file: test_data_full/counter_rel.csv
10/13/2023 20:33:04 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 20:33:04 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 20:33:04 - INFO -     <<< train_file: train2.csv
10/13/2023 20:33:04 - INFO -     <<< train_frame_order: 0
10/13/2023 20:33:04 - INFO -     <<< use_mil: False
10/13/2023 20:33:04 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 20:33:04 - INFO -     <<< val_file: test_data_full/counter_rel.csv
10/13/2023 20:33:04 - INFO -     <<< video_dim: 1024
10/13/2023 20:33:04 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 20:33:04 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 20:33:04 - INFO -     <<< world_size: 1
10/13/2023 20:33:04 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 20:33:05 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 20:33:05 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 20:33:05 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 20:33:05 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 20:33:05 - WARNING -   Test retrieval by loose type.
10/13/2023 20:33:05 - WARNING -   	 embed_dim: 512
10/13/2023 20:33:05 - WARNING -   	 image_resolution: 224
10/13/2023 20:33:05 - WARNING -   	 vision_layers: 12
10/13/2023 20:33:05 - WARNING -   	 vision_width: 768
10/13/2023 20:33:05 - WARNING -   	 vision_patch_size: 32
10/13/2023 20:33:05 - WARNING -   	 context_length: 77
10/13/2023 20:33:05 - WARNING -   	 vocab_size: 49408
10/13/2023 20:33:05 - WARNING -   	 transformer_width: 512
10/13/2023 20:33:05 - WARNING -   	 transformer_heads: 8
10/13/2023 20:33:05 - WARNING -   	 transformer_layers: 12
10/13/2023 20:33:05 - WARNING -   		 linear_patch: 2d
10/13/2023 20:33:05 - WARNING -   	 cut_top_layer: 0
10/13/2023 20:33:06 - WARNING -   	 sim_header: seqTransf
10/13/2023 20:33:13 - INFO -   --------------------
10/13/2023 20:33:13 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 20:33:13 - INFO -   ***** Running test *****
10/13/2023 20:33:13 - INFO -     Num examples = 583
10/13/2023 20:33:13 - INFO -     Batch size = 1
10/13/2023 20:33:13 - INFO -     Num steps = 583
10/13/2023 20:33:13 - INFO -   ***** Running val *****
10/13/2023 20:33:13 - INFO -     Num examples = 583
10/13/2023 21:17:22 - INFO -   sim matrix size: 583, 583
10/13/2023 21:17:23 - INFO -   	 Length-T: 583, Length-V:583
10/13/2023 21:17:23 - INFO -   Text-to-Video:
10/13/2023 21:17:23 - INFO -   	>>>  R@1: 21.1 - R@5: 53.5 - R@10: 70.0 - Median R: 5.0 - Mean R: 12.0
10/13/2023 21:17:23 - INFO -   Video-to-Text:
10/13/2023 21:17:23 - INFO -   	>>>  V2T$R@1: 16.6 - V2T$R@5: 51.3 - V2T$R@10: 67.7 - V2T$Median R: 5.0 - V2T$Mean R: 11.8
10/13/2023 21:17:28 - INFO -   Effective parameters:
10/13/2023 21:17:28 - INFO -     <<< batch_size: 64
10/13/2023 21:17:28 - INFO -     <<< batch_size_val: 1
10/13/2023 21:17:28 - INFO -     <<< cache_dir: 
10/13/2023 21:17:28 - INFO -     <<< coef_lr: 0.001
10/13/2023 21:17:28 - INFO -     <<< cross_model: cross-base
10/13/2023 21:17:28 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 21:17:28 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 21:17:28 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 21:17:28 - INFO -     <<< datatype: moviegraph
10/13/2023 21:17:28 - INFO -     <<< do_eval: True
10/13/2023 21:17:28 - INFO -     <<< do_lower_case: False
10/13/2023 21:17:28 - INFO -     <<< do_pretrain: False
10/13/2023 21:17:28 - INFO -     <<< do_train: False
10/13/2023 21:17:28 - INFO -     <<< epochs: 10
10/13/2023 21:17:28 - INFO -     <<< eval_frame_order: 0
10/13/2023 21:17:28 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 21:17:28 - INFO -     <<< feature_framerate: 1
10/13/2023 21:17:28 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 21:17:28 - INFO -     <<< fp16: False
10/13/2023 21:17:28 - INFO -     <<< fp16_opt_level: O1
10/13/2023 21:17:28 - INFO -     <<< freeze_layer_num: 0
10/13/2023 21:17:28 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 21:17:28 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 21:17:28 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 21:17:28 - INFO -     <<< linear_patch: 2d
10/13/2023 21:17:28 - INFO -     <<< local_rank: 0
10/13/2023 21:17:28 - INFO -     <<< loose_type: True
10/13/2023 21:17:28 - INFO -     <<< lr: 0.0001
10/13/2023 21:17:28 - INFO -     <<< lr_decay: 0.9
10/13/2023 21:17:28 - INFO -     <<< manipulation: counter_rel_mani
10/13/2023 21:17:28 - INFO -     <<< margin: 0.1
10/13/2023 21:17:28 - INFO -     <<< max_frames: 12
10/13/2023 21:17:28 - INFO -     <<< max_words: 60
10/13/2023 21:17:28 - INFO -     <<< n_display: 1
10/13/2023 21:17:28 - INFO -     <<< n_gpu: 1
10/13/2023 21:17:28 - INFO -     <<< n_pair: 1
10/13/2023 21:17:28 - INFO -     <<< negative_weighting: 1
10/13/2023 21:17:28 - INFO -     <<< num_thread_reader: 8
10/13/2023 21:17:28 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 21:17:28 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 21:17:28 - INFO -     <<< rank: 0
10/13/2023 21:17:28 - INFO -     <<< resume_model: None
10/13/2023 21:17:28 - INFO -     <<< sampled_use_mil: False
10/13/2023 21:17:28 - INFO -     <<< scale: 1
10/13/2023 21:17:28 - INFO -     <<< seed: 3
10/13/2023 21:17:28 - INFO -     <<< sim_header: seqTransf
10/13/2023 21:17:28 - INFO -     <<< slice_framepos: 2
10/13/2023 21:17:28 - INFO -     <<< task_type: retrieval
10/13/2023 21:17:28 - INFO -     <<< test_file: test_data_full/counter_rel_mani.csv
10/13/2023 21:17:28 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 21:17:28 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 21:17:28 - INFO -     <<< train_file: train2.csv
10/13/2023 21:17:28 - INFO -     <<< train_frame_order: 0
10/13/2023 21:17:28 - INFO -     <<< use_mil: False
10/13/2023 21:17:28 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 21:17:28 - INFO -     <<< val_file: test_data_full/counter_rel_mani.csv
10/13/2023 21:17:28 - INFO -     <<< video_dim: 1024
10/13/2023 21:17:28 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 21:17:28 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 21:17:28 - INFO -     <<< world_size: 1
10/13/2023 21:17:28 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 21:17:29 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 21:17:29 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 21:17:29 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 21:17:29 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 21:17:29 - WARNING -   Test retrieval by loose type.
10/13/2023 21:17:29 - WARNING -   	 embed_dim: 512
10/13/2023 21:17:29 - WARNING -   	 image_resolution: 224
10/13/2023 21:17:29 - WARNING -   	 vision_layers: 12
10/13/2023 21:17:29 - WARNING -   	 vision_width: 768
10/13/2023 21:17:29 - WARNING -   	 vision_patch_size: 32
10/13/2023 21:17:29 - WARNING -   	 context_length: 77
10/13/2023 21:17:29 - WARNING -   	 vocab_size: 49408
10/13/2023 21:17:29 - WARNING -   	 transformer_width: 512
10/13/2023 21:17:29 - WARNING -   	 transformer_heads: 8
10/13/2023 21:17:29 - WARNING -   	 transformer_layers: 12
10/13/2023 21:17:29 - WARNING -   		 linear_patch: 2d
10/13/2023 21:17:29 - WARNING -   	 cut_top_layer: 0
10/13/2023 21:17:30 - WARNING -   	 sim_header: seqTransf
10/13/2023 21:17:37 - INFO -   --------------------
10/13/2023 21:17:37 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 21:17:37 - INFO -   ***** Running test *****
10/13/2023 21:17:37 - INFO -     Num examples = 583
10/13/2023 21:17:37 - INFO -     Batch size = 1
10/13/2023 21:17:37 - INFO -     Num steps = 583
10/13/2023 21:17:37 - INFO -   ***** Running val *****
10/13/2023 21:17:37 - INFO -     Num examples = 583
10/13/2023 22:03:16 - INFO -   sim matrix size: 583, 583
10/13/2023 22:03:16 - INFO -   	 Length-T: 583, Length-V:583
10/13/2023 22:03:16 - INFO -   Text-to-Video:
10/13/2023 22:03:16 - INFO -   	>>>  R@1: 20.1 - R@5: 52.3 - R@10: 69.3 - Median R: 5.0 - Mean R: 13.2
10/13/2023 22:03:16 - INFO -   Video-to-Text:
10/13/2023 22:03:16 - INFO -   	>>>  V2T$R@1: 17.1 - V2T$R@5: 52.5 - V2T$R@10: 70.6 - V2T$Median R: 5.0 - V2T$Mean R: 12.5
10/13/2023 22:03:22 - INFO -   Effective parameters:
10/13/2023 22:03:22 - INFO -     <<< batch_size: 64
10/13/2023 22:03:22 - INFO -     <<< batch_size_val: 1
10/13/2023 22:03:22 - INFO -     <<< cache_dir: 
10/13/2023 22:03:22 - INFO -     <<< coef_lr: 0.001
10/13/2023 22:03:22 - INFO -     <<< cross_model: cross-base
10/13/2023 22:03:22 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 22:03:22 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 22:03:22 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 22:03:22 - INFO -     <<< datatype: moviegraph
10/13/2023 22:03:22 - INFO -     <<< do_eval: True
10/13/2023 22:03:22 - INFO -     <<< do_lower_case: False
10/13/2023 22:03:22 - INFO -     <<< do_pretrain: False
10/13/2023 22:03:22 - INFO -     <<< do_train: False
10/13/2023 22:03:22 - INFO -     <<< epochs: 10
10/13/2023 22:03:22 - INFO -     <<< eval_frame_order: 0
10/13/2023 22:03:22 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 22:03:22 - INFO -     <<< feature_framerate: 1
10/13/2023 22:03:22 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 22:03:22 - INFO -     <<< fp16: False
10/13/2023 22:03:22 - INFO -     <<< fp16_opt_level: O1
10/13/2023 22:03:22 - INFO -     <<< freeze_layer_num: 0
10/13/2023 22:03:22 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 22:03:22 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 22:03:22 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 22:03:22 - INFO -     <<< linear_patch: 2d
10/13/2023 22:03:22 - INFO -     <<< local_rank: 0
10/13/2023 22:03:22 - INFO -     <<< loose_type: True
10/13/2023 22:03:22 - INFO -     <<< lr: 0.0001
10/13/2023 22:03:22 - INFO -     <<< lr_decay: 0.9
10/13/2023 22:03:22 - INFO -     <<< manipulation: counter_act
10/13/2023 22:03:22 - INFO -     <<< margin: 0.1
10/13/2023 22:03:22 - INFO -     <<< max_frames: 12
10/13/2023 22:03:22 - INFO -     <<< max_words: 60
10/13/2023 22:03:22 - INFO -     <<< n_display: 1
10/13/2023 22:03:22 - INFO -     <<< n_gpu: 1
10/13/2023 22:03:22 - INFO -     <<< n_pair: 1
10/13/2023 22:03:22 - INFO -     <<< negative_weighting: 1
10/13/2023 22:03:22 - INFO -     <<< num_thread_reader: 8
10/13/2023 22:03:22 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 22:03:22 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 22:03:22 - INFO -     <<< rank: 0
10/13/2023 22:03:22 - INFO -     <<< resume_model: None
10/13/2023 22:03:22 - INFO -     <<< sampled_use_mil: False
10/13/2023 22:03:22 - INFO -     <<< scale: 0
10/13/2023 22:03:22 - INFO -     <<< seed: 3
10/13/2023 22:03:22 - INFO -     <<< sim_header: seqTransf
10/13/2023 22:03:22 - INFO -     <<< slice_framepos: 2
10/13/2023 22:03:22 - INFO -     <<< task_type: retrieval
10/13/2023 22:03:22 - INFO -     <<< test_file: test_data_full/counter_act.csv
10/13/2023 22:03:22 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 22:03:22 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 22:03:22 - INFO -     <<< train_file: train2.csv
10/13/2023 22:03:22 - INFO -     <<< train_frame_order: 0
10/13/2023 22:03:22 - INFO -     <<< use_mil: False
10/13/2023 22:03:22 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 22:03:22 - INFO -     <<< val_file: test_data_full/counter_act.csv
10/13/2023 22:03:22 - INFO -     <<< video_dim: 1024
10/13/2023 22:03:22 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 22:03:22 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 22:03:22 - INFO -     <<< world_size: 1
10/13/2023 22:03:22 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 22:03:22 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 22:03:22 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 22:03:22 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 22:03:22 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 22:03:22 - WARNING -   Test retrieval by loose type.
10/13/2023 22:03:22 - WARNING -   	 embed_dim: 512
10/13/2023 22:03:22 - WARNING -   	 image_resolution: 224
10/13/2023 22:03:22 - WARNING -   	 vision_layers: 12
10/13/2023 22:03:22 - WARNING -   	 vision_width: 768
10/13/2023 22:03:22 - WARNING -   	 vision_patch_size: 32
10/13/2023 22:03:22 - WARNING -   	 context_length: 77
10/13/2023 22:03:22 - WARNING -   	 vocab_size: 49408
10/13/2023 22:03:22 - WARNING -   	 transformer_width: 512
10/13/2023 22:03:22 - WARNING -   	 transformer_heads: 8
10/13/2023 22:03:22 - WARNING -   	 transformer_layers: 12
10/13/2023 22:03:22 - WARNING -   		 linear_patch: 2d
10/13/2023 22:03:22 - WARNING -   	 cut_top_layer: 0
10/13/2023 22:03:24 - WARNING -   	 sim_header: seqTransf
10/13/2023 22:03:30 - INFO -   --------------------
10/13/2023 22:03:30 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 22:03:30 - INFO -   ***** Running test *****
10/13/2023 22:03:30 - INFO -     Num examples = 535
10/13/2023 22:03:30 - INFO -     Batch size = 1
10/13/2023 22:03:30 - INFO -     Num steps = 535
10/13/2023 22:03:30 - INFO -   ***** Running val *****
10/13/2023 22:03:30 - INFO -     Num examples = 535
10/13/2023 22:42:18 - INFO -   sim matrix size: 535, 535
10/13/2023 22:42:18 - INFO -   	 Length-T: 535, Length-V:535
10/13/2023 22:42:18 - INFO -   Text-to-Video:
10/13/2023 22:42:18 - INFO -   	>>>  R@1: 25.4 - R@5: 54.8 - R@10: 70.3 - Median R: 4.0 - Mean R: 18.2
10/13/2023 22:42:18 - INFO -   Video-to-Text:
10/13/2023 22:42:18 - INFO -   	>>>  V2T$R@1: 26.1 - V2T$R@5: 56.3 - V2T$R@10: 70.7 - V2T$Median R: 4.0 - V2T$Mean R: 16.6
10/13/2023 22:42:23 - INFO -   Effective parameters:
10/13/2023 22:42:23 - INFO -     <<< batch_size: 64
10/13/2023 22:42:23 - INFO -     <<< batch_size_val: 1
10/13/2023 22:42:23 - INFO -     <<< cache_dir: 
10/13/2023 22:42:23 - INFO -     <<< coef_lr: 0.001
10/13/2023 22:42:23 - INFO -     <<< cross_model: cross-base
10/13/2023 22:42:23 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 22:42:23 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 22:42:23 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 22:42:23 - INFO -     <<< datatype: moviegraph
10/13/2023 22:42:23 - INFO -     <<< do_eval: True
10/13/2023 22:42:23 - INFO -     <<< do_lower_case: False
10/13/2023 22:42:23 - INFO -     <<< do_pretrain: False
10/13/2023 22:42:23 - INFO -     <<< do_train: False
10/13/2023 22:42:23 - INFO -     <<< epochs: 10
10/13/2023 22:42:23 - INFO -     <<< eval_frame_order: 0
10/13/2023 22:42:23 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 22:42:23 - INFO -     <<< feature_framerate: 1
10/13/2023 22:42:23 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 22:42:23 - INFO -     <<< fp16: False
10/13/2023 22:42:23 - INFO -     <<< fp16_opt_level: O1
10/13/2023 22:42:23 - INFO -     <<< freeze_layer_num: 0
10/13/2023 22:42:23 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 22:42:23 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 22:42:23 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 22:42:23 - INFO -     <<< linear_patch: 2d
10/13/2023 22:42:23 - INFO -     <<< local_rank: 0
10/13/2023 22:42:23 - INFO -     <<< loose_type: True
10/13/2023 22:42:23 - INFO -     <<< lr: 0.0001
10/13/2023 22:42:23 - INFO -     <<< lr_decay: 0.9
10/13/2023 22:42:23 - INFO -     <<< manipulation: counter_act_mani
10/13/2023 22:42:23 - INFO -     <<< margin: 0.1
10/13/2023 22:42:23 - INFO -     <<< max_frames: 12
10/13/2023 22:42:23 - INFO -     <<< max_words: 60
10/13/2023 22:42:23 - INFO -     <<< n_display: 1
10/13/2023 22:42:23 - INFO -     <<< n_gpu: 1
10/13/2023 22:42:23 - INFO -     <<< n_pair: 1
10/13/2023 22:42:23 - INFO -     <<< negative_weighting: 1
10/13/2023 22:42:23 - INFO -     <<< num_thread_reader: 8
10/13/2023 22:42:23 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 22:42:23 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 22:42:23 - INFO -     <<< rank: 0
10/13/2023 22:42:23 - INFO -     <<< resume_model: None
10/13/2023 22:42:23 - INFO -     <<< sampled_use_mil: False
10/13/2023 22:42:23 - INFO -     <<< scale: 1
10/13/2023 22:42:23 - INFO -     <<< seed: 3
10/13/2023 22:42:23 - INFO -     <<< sim_header: seqTransf
10/13/2023 22:42:23 - INFO -     <<< slice_framepos: 2
10/13/2023 22:42:23 - INFO -     <<< task_type: retrieval
10/13/2023 22:42:23 - INFO -     <<< test_file: test_data_full/counter_act_mani.csv
10/13/2023 22:42:23 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 22:42:23 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 22:42:23 - INFO -     <<< train_file: train2.csv
10/13/2023 22:42:23 - INFO -     <<< train_frame_order: 0
10/13/2023 22:42:23 - INFO -     <<< use_mil: False
10/13/2023 22:42:23 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 22:42:23 - INFO -     <<< val_file: test_data_full/counter_act_mani.csv
10/13/2023 22:42:23 - INFO -     <<< video_dim: 1024
10/13/2023 22:42:23 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 22:42:23 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 22:42:23 - INFO -     <<< world_size: 1
10/13/2023 22:42:23 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 22:42:24 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 22:42:24 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 22:42:24 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 22:42:24 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 22:42:24 - WARNING -   Test retrieval by loose type.
10/13/2023 22:42:24 - WARNING -   	 embed_dim: 512
10/13/2023 22:42:24 - WARNING -   	 image_resolution: 224
10/13/2023 22:42:24 - WARNING -   	 vision_layers: 12
10/13/2023 22:42:24 - WARNING -   	 vision_width: 768
10/13/2023 22:42:24 - WARNING -   	 vision_patch_size: 32
10/13/2023 22:42:24 - WARNING -   	 context_length: 77
10/13/2023 22:42:24 - WARNING -   	 vocab_size: 49408
10/13/2023 22:42:24 - WARNING -   	 transformer_width: 512
10/13/2023 22:42:24 - WARNING -   	 transformer_heads: 8
10/13/2023 22:42:24 - WARNING -   	 transformer_layers: 12
10/13/2023 22:42:24 - WARNING -   		 linear_patch: 2d
10/13/2023 22:42:24 - WARNING -   	 cut_top_layer: 0
10/13/2023 22:42:26 - WARNING -   	 sim_header: seqTransf
10/13/2023 22:42:32 - INFO -   --------------------
10/13/2023 22:42:32 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 22:42:32 - INFO -   ***** Running test *****
10/13/2023 22:42:32 - INFO -     Num examples = 535
10/13/2023 22:42:32 - INFO -     Batch size = 1
10/13/2023 22:42:32 - INFO -     Num steps = 535
10/13/2023 22:42:32 - INFO -   ***** Running val *****
10/13/2023 22:42:32 - INFO -     Num examples = 535
10/13/2023 23:22:12 - INFO -   sim matrix size: 535, 535
10/13/2023 23:22:12 - INFO -   	 Length-T: 535, Length-V:535
10/13/2023 23:22:12 - INFO -   Text-to-Video:
10/13/2023 23:22:12 - INFO -   	>>>  R@1: 23.0 - R@5: 52.1 - R@10: 67.5 - Median R: 5.0 - Mean R: 19.5
10/13/2023 23:22:12 - INFO -   Video-to-Text:
10/13/2023 23:22:12 - INFO -   	>>>  V2T$R@1: 22.3 - V2T$R@5: 53.5 - V2T$R@10: 68.4 - V2T$Median R: 5.0 - V2T$Mean R: 18.1
10/13/2023 23:22:17 - INFO -   Effective parameters:
10/13/2023 23:22:17 - INFO -     <<< batch_size: 64
10/13/2023 23:22:17 - INFO -     <<< batch_size_val: 1
10/13/2023 23:22:17 - INFO -     <<< cache_dir: 
10/13/2023 23:22:17 - INFO -     <<< coef_lr: 0.001
10/13/2023 23:22:17 - INFO -     <<< cross_model: cross-base
10/13/2023 23:22:17 - INFO -     <<< cross_num_hidden_layers: 4
10/13/2023 23:22:17 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/13/2023 23:22:17 - INFO -     <<< dataset_ckpt: seed3
10/13/2023 23:22:17 - INFO -     <<< datatype: moviegraph
10/13/2023 23:22:17 - INFO -     <<< do_eval: True
10/13/2023 23:22:17 - INFO -     <<< do_lower_case: False
10/13/2023 23:22:17 - INFO -     <<< do_pretrain: False
10/13/2023 23:22:17 - INFO -     <<< do_train: False
10/13/2023 23:22:17 - INFO -     <<< epochs: 10
10/13/2023 23:22:17 - INFO -     <<< eval_frame_order: 0
10/13/2023 23:22:17 - INFO -     <<< expand_msrvtt_sentences: False
10/13/2023 23:22:17 - INFO -     <<< feature_framerate: 1
10/13/2023 23:22:17 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/13/2023 23:22:17 - INFO -     <<< fp16: False
10/13/2023 23:22:17 - INFO -     <<< fp16_opt_level: O1
10/13/2023 23:22:17 - INFO -     <<< freeze_layer_num: 0
10/13/2023 23:22:17 - INFO -     <<< gradient_accumulation_steps: 1
10/13/2023 23:22:17 - INFO -     <<< hard_negative_rate: 0.5
10/13/2023 23:22:17 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/13/2023 23:22:17 - INFO -     <<< linear_patch: 2d
10/13/2023 23:22:17 - INFO -     <<< local_rank: 0
10/13/2023 23:22:17 - INFO -     <<< loose_type: True
10/13/2023 23:22:17 - INFO -     <<< lr: 0.0001
10/13/2023 23:22:17 - INFO -     <<< lr_decay: 0.9
10/13/2023 23:22:17 - INFO -     <<< manipulation: counter_int
10/13/2023 23:22:17 - INFO -     <<< margin: 0.1
10/13/2023 23:22:17 - INFO -     <<< max_frames: 12
10/13/2023 23:22:17 - INFO -     <<< max_words: 60
10/13/2023 23:22:17 - INFO -     <<< n_display: 1
10/13/2023 23:22:17 - INFO -     <<< n_gpu: 1
10/13/2023 23:22:17 - INFO -     <<< n_pair: 1
10/13/2023 23:22:17 - INFO -     <<< negative_weighting: 1
10/13/2023 23:22:17 - INFO -     <<< num_thread_reader: 8
10/13/2023 23:22:17 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/13/2023 23:22:17 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/13/2023 23:22:17 - INFO -     <<< rank: 0
10/13/2023 23:22:17 - INFO -     <<< resume_model: None
10/13/2023 23:22:17 - INFO -     <<< sampled_use_mil: False
10/13/2023 23:22:17 - INFO -     <<< scale: 0
10/13/2023 23:22:17 - INFO -     <<< seed: 3
10/13/2023 23:22:17 - INFO -     <<< sim_header: seqTransf
10/13/2023 23:22:17 - INFO -     <<< slice_framepos: 2
10/13/2023 23:22:17 - INFO -     <<< task_type: retrieval
10/13/2023 23:22:17 - INFO -     <<< test_file: test_data_full/counter_int.csv
10/13/2023 23:22:17 - INFO -     <<< text_num_hidden_layers: 12
10/13/2023 23:22:17 - INFO -     <<< train_csv: data/.train.csv
10/13/2023 23:22:17 - INFO -     <<< train_file: train2.csv
10/13/2023 23:22:17 - INFO -     <<< train_frame_order: 0
10/13/2023 23:22:17 - INFO -     <<< use_mil: False
10/13/2023 23:22:17 - INFO -     <<< val_csv: data/.val.csv
10/13/2023 23:22:17 - INFO -     <<< val_file: test_data_full/counter_int.csv
10/13/2023 23:22:17 - INFO -     <<< video_dim: 1024
10/13/2023 23:22:17 - INFO -     <<< visual_num_hidden_layers: 12
10/13/2023 23:22:17 - INFO -     <<< warmup_proportion: 0.1
10/13/2023 23:22:17 - INFO -     <<< world_size: 1
10/13/2023 23:22:17 - INFO -   device: cuda:0 n_gpu: 1
10/13/2023 23:22:18 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/13/2023 23:22:18 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/13/2023 23:22:18 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/13/2023 23:22:18 - WARNING -   Stage-One:True, Stage-Two:False
10/13/2023 23:22:18 - WARNING -   Test retrieval by loose type.
10/13/2023 23:22:18 - WARNING -   	 embed_dim: 512
10/13/2023 23:22:18 - WARNING -   	 image_resolution: 224
10/13/2023 23:22:18 - WARNING -   	 vision_layers: 12
10/13/2023 23:22:18 - WARNING -   	 vision_width: 768
10/13/2023 23:22:18 - WARNING -   	 vision_patch_size: 32
10/13/2023 23:22:18 - WARNING -   	 context_length: 77
10/13/2023 23:22:18 - WARNING -   	 vocab_size: 49408
10/13/2023 23:22:18 - WARNING -   	 transformer_width: 512
10/13/2023 23:22:18 - WARNING -   	 transformer_heads: 8
10/13/2023 23:22:18 - WARNING -   	 transformer_layers: 12
10/13/2023 23:22:18 - WARNING -   		 linear_patch: 2d
10/13/2023 23:22:18 - WARNING -   	 cut_top_layer: 0
10/13/2023 23:22:19 - WARNING -   	 sim_header: seqTransf
10/13/2023 23:22:26 - INFO -   --------------------
10/13/2023 23:22:26 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/13/2023 23:22:26 - INFO -   ***** Running test *****
10/13/2023 23:22:26 - INFO -     Num examples = 591
10/13/2023 23:22:26 - INFO -     Batch size = 1
10/13/2023 23:22:26 - INFO -     Num steps = 591
10/13/2023 23:22:26 - INFO -   ***** Running val *****
10/13/2023 23:22:26 - INFO -     Num examples = 591
10/14/2023 00:07:39 - INFO -   sim matrix size: 591, 591
10/14/2023 00:07:39 - INFO -   	 Length-T: 591, Length-V:591
10/14/2023 00:07:39 - INFO -   Text-to-Video:
10/14/2023 00:07:39 - INFO -   	>>>  R@1: 23.5 - R@5: 58.4 - R@10: 74.6 - Median R: 4.0 - Mean R: 11.4
10/14/2023 00:07:39 - INFO -   Video-to-Text:
10/14/2023 00:07:39 - INFO -   	>>>  V2T$R@1: 22.6 - V2T$R@5: 57.2 - V2T$R@10: 73.6 - V2T$Median R: 4.0 - V2T$Mean R: 11.0
10/14/2023 00:07:45 - INFO -   Effective parameters:
10/14/2023 00:07:45 - INFO -     <<< batch_size: 64
10/14/2023 00:07:45 - INFO -     <<< batch_size_val: 1
10/14/2023 00:07:45 - INFO -     <<< cache_dir: 
10/14/2023 00:07:45 - INFO -     <<< coef_lr: 0.001
10/14/2023 00:07:45 - INFO -     <<< cross_model: cross-base
10/14/2023 00:07:45 - INFO -     <<< cross_num_hidden_layers: 4
10/14/2023 00:07:45 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/14/2023 00:07:45 - INFO -     <<< dataset_ckpt: seed3
10/14/2023 00:07:45 - INFO -     <<< datatype: moviegraph
10/14/2023 00:07:45 - INFO -     <<< do_eval: True
10/14/2023 00:07:45 - INFO -     <<< do_lower_case: False
10/14/2023 00:07:45 - INFO -     <<< do_pretrain: False
10/14/2023 00:07:45 - INFO -     <<< do_train: False
10/14/2023 00:07:45 - INFO -     <<< epochs: 10
10/14/2023 00:07:45 - INFO -     <<< eval_frame_order: 0
10/14/2023 00:07:45 - INFO -     <<< expand_msrvtt_sentences: False
10/14/2023 00:07:45 - INFO -     <<< feature_framerate: 1
10/14/2023 00:07:45 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/14/2023 00:07:45 - INFO -     <<< fp16: False
10/14/2023 00:07:45 - INFO -     <<< fp16_opt_level: O1
10/14/2023 00:07:45 - INFO -     <<< freeze_layer_num: 0
10/14/2023 00:07:45 - INFO -     <<< gradient_accumulation_steps: 1
10/14/2023 00:07:45 - INFO -     <<< hard_negative_rate: 0.5
10/14/2023 00:07:45 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/14/2023 00:07:45 - INFO -     <<< linear_patch: 2d
10/14/2023 00:07:45 - INFO -     <<< local_rank: 0
10/14/2023 00:07:45 - INFO -     <<< loose_type: True
10/14/2023 00:07:45 - INFO -     <<< lr: 0.0001
10/14/2023 00:07:45 - INFO -     <<< lr_decay: 0.9
10/14/2023 00:07:45 - INFO -     <<< manipulation: counter_int_mani
10/14/2023 00:07:45 - INFO -     <<< margin: 0.1
10/14/2023 00:07:45 - INFO -     <<< max_frames: 12
10/14/2023 00:07:45 - INFO -     <<< max_words: 60
10/14/2023 00:07:45 - INFO -     <<< n_display: 1
10/14/2023 00:07:45 - INFO -     <<< n_gpu: 1
10/14/2023 00:07:45 - INFO -     <<< n_pair: 1
10/14/2023 00:07:45 - INFO -     <<< negative_weighting: 1
10/14/2023 00:07:45 - INFO -     <<< num_thread_reader: 8
10/14/2023 00:07:45 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/14/2023 00:07:45 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/14/2023 00:07:45 - INFO -     <<< rank: 0
10/14/2023 00:07:45 - INFO -     <<< resume_model: None
10/14/2023 00:07:45 - INFO -     <<< sampled_use_mil: False
10/14/2023 00:07:45 - INFO -     <<< scale: 1
10/14/2023 00:07:45 - INFO -     <<< seed: 3
10/14/2023 00:07:45 - INFO -     <<< sim_header: seqTransf
10/14/2023 00:07:45 - INFO -     <<< slice_framepos: 2
10/14/2023 00:07:45 - INFO -     <<< task_type: retrieval
10/14/2023 00:07:45 - INFO -     <<< test_file: test_data_full/counter_int_mani.csv
10/14/2023 00:07:45 - INFO -     <<< text_num_hidden_layers: 12
10/14/2023 00:07:45 - INFO -     <<< train_csv: data/.train.csv
10/14/2023 00:07:45 - INFO -     <<< train_file: train2.csv
10/14/2023 00:07:45 - INFO -     <<< train_frame_order: 0
10/14/2023 00:07:45 - INFO -     <<< use_mil: False
10/14/2023 00:07:45 - INFO -     <<< val_csv: data/.val.csv
10/14/2023 00:07:45 - INFO -     <<< val_file: test_data_full/counter_int_mani.csv
10/14/2023 00:07:45 - INFO -     <<< video_dim: 1024
10/14/2023 00:07:45 - INFO -     <<< visual_num_hidden_layers: 12
10/14/2023 00:07:45 - INFO -     <<< warmup_proportion: 0.1
10/14/2023 00:07:45 - INFO -     <<< world_size: 1
10/14/2023 00:07:45 - INFO -   device: cuda:0 n_gpu: 1
10/14/2023 00:07:46 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/14/2023 00:07:46 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/14/2023 00:07:46 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/14/2023 00:07:46 - WARNING -   Stage-One:True, Stage-Two:False
10/14/2023 00:07:46 - WARNING -   Test retrieval by loose type.
10/14/2023 00:07:46 - WARNING -   	 embed_dim: 512
10/14/2023 00:07:46 - WARNING -   	 image_resolution: 224
10/14/2023 00:07:46 - WARNING -   	 vision_layers: 12
10/14/2023 00:07:46 - WARNING -   	 vision_width: 768
10/14/2023 00:07:46 - WARNING -   	 vision_patch_size: 32
10/14/2023 00:07:46 - WARNING -   	 context_length: 77
10/14/2023 00:07:46 - WARNING -   	 vocab_size: 49408
10/14/2023 00:07:46 - WARNING -   	 transformer_width: 512
10/14/2023 00:07:46 - WARNING -   	 transformer_heads: 8
10/14/2023 00:07:46 - WARNING -   	 transformer_layers: 12
10/14/2023 00:07:46 - WARNING -   		 linear_patch: 2d
10/14/2023 00:07:46 - WARNING -   	 cut_top_layer: 0
10/14/2023 00:07:47 - WARNING -   	 sim_header: seqTransf
10/14/2023 00:07:54 - INFO -   --------------------
10/14/2023 00:07:54 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/14/2023 00:07:54 - INFO -   ***** Running test *****
10/14/2023 00:07:54 - INFO -     Num examples = 591
10/14/2023 00:07:54 - INFO -     Batch size = 1
10/14/2023 00:07:54 - INFO -     Num steps = 591
10/14/2023 00:07:54 - INFO -   ***** Running val *****
10/14/2023 00:07:54 - INFO -     Num examples = 591
10/14/2023 00:53:22 - INFO -   sim matrix size: 591, 591
10/14/2023 00:53:22 - INFO -   	 Length-T: 591, Length-V:591
10/14/2023 00:53:22 - INFO -   Text-to-Video:
10/14/2023 00:53:22 - INFO -   	>>>  R@1: 20.8 - R@5: 54.5 - R@10: 71.7 - Median R: 5.0 - Mean R: 13.1
10/14/2023 00:53:22 - INFO -   Video-to-Text:
10/14/2023 00:53:22 - INFO -   	>>>  V2T$R@1: 18.5 - V2T$R@5: 52.4 - V2T$R@10: 71.2 - V2T$Median R: 5.0 - V2T$Mean R: 13.8
10/14/2023 00:53:28 - INFO -   Effective parameters:
10/14/2023 00:53:28 - INFO -     <<< batch_size: 64
10/14/2023 00:53:28 - INFO -     <<< batch_size_val: 1
10/14/2023 00:53:28 - INFO -     <<< cache_dir: 
10/14/2023 00:53:28 - INFO -     <<< coef_lr: 0.001
10/14/2023 00:53:28 - INFO -     <<< cross_model: cross-base
10/14/2023 00:53:28 - INFO -     <<< cross_num_hidden_layers: 4
10/14/2023 00:53:28 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/14/2023 00:53:28 - INFO -     <<< dataset_ckpt: seed3
10/14/2023 00:53:28 - INFO -     <<< datatype: moviegraph
10/14/2023 00:53:28 - INFO -     <<< do_eval: True
10/14/2023 00:53:28 - INFO -     <<< do_lower_case: False
10/14/2023 00:53:28 - INFO -     <<< do_pretrain: False
10/14/2023 00:53:28 - INFO -     <<< do_train: False
10/14/2023 00:53:28 - INFO -     <<< epochs: 10
10/14/2023 00:53:28 - INFO -     <<< eval_frame_order: 0
10/14/2023 00:53:28 - INFO -     <<< expand_msrvtt_sentences: False
10/14/2023 00:53:28 - INFO -     <<< feature_framerate: 1
10/14/2023 00:53:28 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/14/2023 00:53:28 - INFO -     <<< fp16: False
10/14/2023 00:53:28 - INFO -     <<< fp16_opt_level: O1
10/14/2023 00:53:28 - INFO -     <<< freeze_layer_num: 0
10/14/2023 00:53:28 - INFO -     <<< gradient_accumulation_steps: 1
10/14/2023 00:53:28 - INFO -     <<< hard_negative_rate: 0.5
10/14/2023 00:53:28 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/14/2023 00:53:28 - INFO -     <<< linear_patch: 2d
10/14/2023 00:53:28 - INFO -     <<< local_rank: 0
10/14/2023 00:53:28 - INFO -     <<< loose_type: True
10/14/2023 00:53:28 - INFO -     <<< lr: 0.0001
10/14/2023 00:53:28 - INFO -     <<< lr_decay: 0.9
10/14/2023 00:53:28 - INFO -     <<< manipulation: counter_attr
10/14/2023 00:53:28 - INFO -     <<< margin: 0.1
10/14/2023 00:53:28 - INFO -     <<< max_frames: 12
10/14/2023 00:53:28 - INFO -     <<< max_words: 60
10/14/2023 00:53:28 - INFO -     <<< n_display: 1
10/14/2023 00:53:28 - INFO -     <<< n_gpu: 1
10/14/2023 00:53:28 - INFO -     <<< n_pair: 1
10/14/2023 00:53:28 - INFO -     <<< negative_weighting: 1
10/14/2023 00:53:28 - INFO -     <<< num_thread_reader: 8
10/14/2023 00:53:28 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/14/2023 00:53:28 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/14/2023 00:53:28 - INFO -     <<< rank: 0
10/14/2023 00:53:28 - INFO -     <<< resume_model: None
10/14/2023 00:53:28 - INFO -     <<< sampled_use_mil: False
10/14/2023 00:53:28 - INFO -     <<< scale: 0
10/14/2023 00:53:28 - INFO -     <<< seed: 3
10/14/2023 00:53:28 - INFO -     <<< sim_header: seqTransf
10/14/2023 00:53:28 - INFO -     <<< slice_framepos: 2
10/14/2023 00:53:28 - INFO -     <<< task_type: retrieval
10/14/2023 00:53:28 - INFO -     <<< test_file: test_data_full/counter_attr.csv
10/14/2023 00:53:28 - INFO -     <<< text_num_hidden_layers: 12
10/14/2023 00:53:28 - INFO -     <<< train_csv: data/.train.csv
10/14/2023 00:53:28 - INFO -     <<< train_file: train2.csv
10/14/2023 00:53:28 - INFO -     <<< train_frame_order: 0
10/14/2023 00:53:28 - INFO -     <<< use_mil: False
10/14/2023 00:53:28 - INFO -     <<< val_csv: data/.val.csv
10/14/2023 00:53:28 - INFO -     <<< val_file: test_data_full/counter_attr.csv
10/14/2023 00:53:28 - INFO -     <<< video_dim: 1024
10/14/2023 00:53:28 - INFO -     <<< visual_num_hidden_layers: 12
10/14/2023 00:53:28 - INFO -     <<< warmup_proportion: 0.1
10/14/2023 00:53:28 - INFO -     <<< world_size: 1
10/14/2023 00:53:28 - INFO -   device: cuda:0 n_gpu: 1
10/14/2023 00:53:29 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/14/2023 00:53:29 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/14/2023 00:53:29 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/14/2023 00:53:29 - WARNING -   Stage-One:True, Stage-Two:False
10/14/2023 00:53:29 - WARNING -   Test retrieval by loose type.
10/14/2023 00:53:29 - WARNING -   	 embed_dim: 512
10/14/2023 00:53:29 - WARNING -   	 image_resolution: 224
10/14/2023 00:53:29 - WARNING -   	 vision_layers: 12
10/14/2023 00:53:29 - WARNING -   	 vision_width: 768
10/14/2023 00:53:29 - WARNING -   	 vision_patch_size: 32
10/14/2023 00:53:29 - WARNING -   	 context_length: 77
10/14/2023 00:53:29 - WARNING -   	 vocab_size: 49408
10/14/2023 00:53:29 - WARNING -   	 transformer_width: 512
10/14/2023 00:53:29 - WARNING -   	 transformer_heads: 8
10/14/2023 00:53:29 - WARNING -   	 transformer_layers: 12
10/14/2023 00:53:29 - WARNING -   		 linear_patch: 2d
10/14/2023 00:53:29 - WARNING -   	 cut_top_layer: 0
10/14/2023 00:53:31 - WARNING -   	 sim_header: seqTransf
10/14/2023 00:53:37 - INFO -   --------------------
10/14/2023 00:53:37 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/14/2023 00:53:38 - INFO -   ***** Running test *****
10/14/2023 00:53:38 - INFO -     Num examples = 591
10/14/2023 00:53:38 - INFO -     Batch size = 1
10/14/2023 00:53:38 - INFO -     Num steps = 591
10/14/2023 00:53:38 - INFO -   ***** Running val *****
10/14/2023 00:53:38 - INFO -     Num examples = 591
10/14/2023 01:38:57 - INFO -   sim matrix size: 591, 591
10/14/2023 01:38:57 - INFO -   	 Length-T: 591, Length-V:591
10/14/2023 01:38:57 - INFO -   Text-to-Video:
10/14/2023 01:38:57 - INFO -   	>>>  R@1: 19.6 - R@5: 44.7 - R@10: 60.9 - Median R: 7.0 - Mean R: 28.2
10/14/2023 01:38:57 - INFO -   Video-to-Text:
10/14/2023 01:38:57 - INFO -   	>>>  V2T$R@1: 17.4 - V2T$R@5: 43.5 - V2T$R@10: 59.3 - V2T$Median R: 7.0 - V2T$Mean R: 25.7
10/14/2023 01:39:06 - INFO -   Effective parameters:
10/14/2023 01:39:06 - INFO -     <<< batch_size: 64
10/14/2023 01:39:06 - INFO -     <<< batch_size_val: 1
10/14/2023 01:39:06 - INFO -     <<< cache_dir: 
10/14/2023 01:39:06 - INFO -     <<< coef_lr: 0.001
10/14/2023 01:39:06 - INFO -     <<< cross_model: cross-base
10/14/2023 01:39:06 - INFO -     <<< cross_num_hidden_layers: 4
10/14/2023 01:39:06 - INFO -     <<< data_path: /home/wiss/zhang/Jinhe/video-attr-prober/Data/MovieGraph/
10/14/2023 01:39:06 - INFO -     <<< dataset_ckpt: seed3
10/14/2023 01:39:06 - INFO -     <<< datatype: moviegraph
10/14/2023 01:39:06 - INFO -     <<< do_eval: True
10/14/2023 01:39:06 - INFO -     <<< do_lower_case: False
10/14/2023 01:39:06 - INFO -     <<< do_pretrain: False
10/14/2023 01:39:06 - INFO -     <<< do_train: False
10/14/2023 01:39:06 - INFO -     <<< epochs: 10
10/14/2023 01:39:06 - INFO -     <<< eval_frame_order: 0
10/14/2023 01:39:06 - INFO -     <<< expand_msrvtt_sentences: False
10/14/2023 01:39:06 - INFO -     <<< feature_framerate: 1
10/14/2023 01:39:06 - INFO -     <<< features_path: /nfs/data2/zhang/MovieGraph/clips_compressed
10/14/2023 01:39:06 - INFO -     <<< fp16: False
10/14/2023 01:39:06 - INFO -     <<< fp16_opt_level: O1
10/14/2023 01:39:06 - INFO -     <<< freeze_layer_num: 0
10/14/2023 01:39:06 - INFO -     <<< gradient_accumulation_steps: 1
10/14/2023 01:39:06 - INFO -     <<< hard_negative_rate: 0.5
10/14/2023 01:39:06 - INFO -     <<< init_model: /home/wiss/zhang/nfs/video_prober/xclip/mg_train2_seed3/pytorch_model.bin.9
10/14/2023 01:39:06 - INFO -     <<< linear_patch: 2d
10/14/2023 01:39:06 - INFO -     <<< local_rank: 0
10/14/2023 01:39:06 - INFO -     <<< loose_type: True
10/14/2023 01:39:06 - INFO -     <<< lr: 0.0001
10/14/2023 01:39:06 - INFO -     <<< lr_decay: 0.9
10/14/2023 01:39:06 - INFO -     <<< manipulation: counter_attr_mani
10/14/2023 01:39:06 - INFO -     <<< margin: 0.1
10/14/2023 01:39:06 - INFO -     <<< max_frames: 12
10/14/2023 01:39:06 - INFO -     <<< max_words: 60
10/14/2023 01:39:06 - INFO -     <<< n_display: 1
10/14/2023 01:39:06 - INFO -     <<< n_gpu: 1
10/14/2023 01:39:06 - INFO -     <<< n_pair: 1
10/14/2023 01:39:06 - INFO -     <<< negative_weighting: 1
10/14/2023 01:39:06 - INFO -     <<< num_thread_reader: 8
10/14/2023 01:39:06 - INFO -     <<< output_dir: /home/wiss/zhang/nfs/Mg_ckpt/xclip/
10/14/2023 01:39:06 - INFO -     <<< pretrained_clip_name: ViT-B/32
10/14/2023 01:39:06 - INFO -     <<< rank: 0
10/14/2023 01:39:06 - INFO -     <<< resume_model: None
10/14/2023 01:39:06 - INFO -     <<< sampled_use_mil: False
10/14/2023 01:39:06 - INFO -     <<< scale: 1
10/14/2023 01:39:06 - INFO -     <<< seed: 3
10/14/2023 01:39:06 - INFO -     <<< sim_header: seqTransf
10/14/2023 01:39:06 - INFO -     <<< slice_framepos: 2
10/14/2023 01:39:06 - INFO -     <<< task_type: retrieval
10/14/2023 01:39:06 - INFO -     <<< test_file: test_data_full/counter_attr_mani.csv
10/14/2023 01:39:06 - INFO -     <<< text_num_hidden_layers: 12
10/14/2023 01:39:06 - INFO -     <<< train_csv: data/.train.csv
10/14/2023 01:39:06 - INFO -     <<< train_file: train2.csv
10/14/2023 01:39:06 - INFO -     <<< train_frame_order: 0
10/14/2023 01:39:06 - INFO -     <<< use_mil: False
10/14/2023 01:39:06 - INFO -     <<< val_csv: data/.val.csv
10/14/2023 01:39:06 - INFO -     <<< val_file: test_data_full/counter_attr_mani.csv
10/14/2023 01:39:06 - INFO -     <<< video_dim: 1024
10/14/2023 01:39:06 - INFO -     <<< visual_num_hidden_layers: 12
10/14/2023 01:39:06 - INFO -     <<< warmup_proportion: 0.1
10/14/2023 01:39:06 - INFO -     <<< world_size: 1
10/14/2023 01:39:06 - INFO -   device: cuda:0 n_gpu: 1
10/14/2023 01:39:08 - INFO -   loading archive file /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base
10/14/2023 01:39:08 - INFO -   Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

10/14/2023 01:39:08 - INFO -   Weight doesn't exsits. /home/wiss/zhang/Jinhe/X-CLIP/modules/cross-base/cross_pytorch_model.bin
10/14/2023 01:39:08 - WARNING -   Stage-One:True, Stage-Two:False
10/14/2023 01:39:08 - WARNING -   Test retrieval by loose type.
10/14/2023 01:39:08 - WARNING -   	 embed_dim: 512
10/14/2023 01:39:08 - WARNING -   	 image_resolution: 224
10/14/2023 01:39:08 - WARNING -   	 vision_layers: 12
10/14/2023 01:39:08 - WARNING -   	 vision_width: 768
10/14/2023 01:39:08 - WARNING -   	 vision_patch_size: 32
10/14/2023 01:39:08 - WARNING -   	 context_length: 77
10/14/2023 01:39:08 - WARNING -   	 vocab_size: 49408
10/14/2023 01:39:08 - WARNING -   	 transformer_width: 512
10/14/2023 01:39:08 - WARNING -   	 transformer_heads: 8
10/14/2023 01:39:08 - WARNING -   	 transformer_layers: 12
10/14/2023 01:39:08 - WARNING -   		 linear_patch: 2d
10/14/2023 01:39:08 - WARNING -   	 cut_top_layer: 0
10/14/2023 01:39:10 - WARNING -   	 sim_header: seqTransf
10/14/2023 01:39:16 - INFO -   --------------------
10/14/2023 01:39:16 - INFO -   Weights from pretrained model not used in XCLIP: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
10/14/2023 01:39:16 - INFO -   ***** Running test *****
10/14/2023 01:39:16 - INFO -     Num examples = 591
10/14/2023 01:39:16 - INFO -     Batch size = 1
10/14/2023 01:39:16 - INFO -     Num steps = 591
10/14/2023 01:39:16 - INFO -   ***** Running val *****
10/14/2023 01:39:16 - INFO -     Num examples = 591
10/14/2023 02:24:57 - INFO -   sim matrix size: 591, 591
10/14/2023 02:24:58 - INFO -   	 Length-T: 591, Length-V:591
10/14/2023 02:24:58 - INFO -   Text-to-Video:
10/14/2023 02:24:58 - INFO -   	>>>  R@1: 18.8 - R@5: 42.0 - R@10: 58.9 - Median R: 7.0 - Mean R: 32.1
10/14/2023 02:24:58 - INFO -   Video-to-Text:
10/14/2023 02:24:58 - INFO -   	>>>  V2T$R@1: 16.0 - V2T$R@5: 44.4 - V2T$R@10: 57.9 - V2T$Median R: 7.0 - V2T$Mean R: 30.2
